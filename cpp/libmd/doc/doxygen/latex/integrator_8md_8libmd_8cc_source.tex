\hypertarget{integrator_8md_8libmd_8cc_source}{}\doxysection{integrator.\+md.\+libmd.\+cc}
\label{integrator_8md_8libmd_8cc_source}\index{libmd-\/src/md/integrator.md.libmd.cc@{libmd-\/src/md/integrator.md.libmd.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{integrator_8md_8libmd_8cc_source_l00001}\mbox{\hyperlink{integrator_8md_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}{00001}} \textcolor{preprocessor}{\#define \_\_libmd\_src\_file\_\_}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#ifndef libmd\_h}}
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include "../../libmd.h"}}
\DoxyCodeLine{00004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00005 }
\DoxyCodeLine{\Hypertarget{integrator_8md_8libmd_8cc_source_l00006}\mbox{\hyperlink{structmd_ab268b10a893abd008382df06da416a5a_ab268b10a893abd008382df06da416a5a}{00006}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_ab268b10a893abd008382df06da416a5a_ab268b10a893abd008382df06da416a5a}{md<dim>::thread\_seuler}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00016     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} o=integrator.h/particles[i].m;}
\DoxyCodeLine{00017     memcpy(particles[i].xp,particles[i].x,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00018     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++)}
\DoxyCodeLine{00019     \{}
\DoxyCodeLine{00020         particles[i].dx[d]+=o*particles[i].F[d];}
\DoxyCodeLine{00021         particles[i].x[d]+=integrator.h*particles[i].dx[d];}
\DoxyCodeLine{00022     \}}
\DoxyCodeLine{00023 \}}
\DoxyCodeLine{00024 }
\DoxyCodeLine{\Hypertarget{integrator_8md_8libmd_8cc_source_l00025}\mbox{\hyperlink{structmd_a151360bcbdea5b086399aded05d7ade8_a151360bcbdea5b086399aded05d7ade8}{00025}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_a151360bcbdea5b086399aded05d7ade8_a151360bcbdea5b086399aded05d7ade8}{md<dim>::thread\_vverlet\_x}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00026 \{}
\DoxyCodeLine{00036     memcpy(particles[i].xp,particles[i].x,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00037     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].x[d]+=integrator.h*particles[i].dx[d]+0.5*\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(integrator.h,2)*particles[i].F[d]/particles[i].m;}
\DoxyCodeLine{00038 \}}
\DoxyCodeLine{00039 }
\DoxyCodeLine{\Hypertarget{integrator_8md_8libmd_8cc_source_l00040}\mbox{\hyperlink{structmd_aab0e1d2ec505cfb5160de37b470c1f1b_aab0e1d2ec505cfb5160de37b470c1f1b}{00040}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_aab0e1d2ec505cfb5160de37b470c1f1b_aab0e1d2ec505cfb5160de37b470c1f1b}{md<dim>::thread\_vverlet\_dx}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00041 \{}
\DoxyCodeLine{00051     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].dx[d]+=0.5*integrator.h*particles[i].F[d]/particles[i].m;}
\DoxyCodeLine{00052 \}}
\DoxyCodeLine{00053 }
\DoxyCodeLine{\Hypertarget{integrator_8md_8libmd_8cc_source_l00054}\mbox{\hyperlink{structmd_a79f30630408b53f5cfb308e4700cc627_a79f30630408b53f5cfb308e4700cc627}{00054}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_a79f30630408b53f5cfb308e4700cc627_a79f30630408b53f5cfb308e4700cc627}{md<dim>::thread\_first\_order}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00055 \{}
\DoxyCodeLine{00060     memcpy(particles[i].xp,particles[i].x,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00061     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].x[d]+=integrator.h*particles[i].dx[d];}
\DoxyCodeLine{00062 \}}
\DoxyCodeLine{00063 }
\DoxyCodeLine{\Hypertarget{integrator_8md_8libmd_8cc_source_l00064}\mbox{\hyperlink{structmd_af9208aee87634536a1a00cc1346d8b56_af9208aee87634536a1a00cc1346d8b56}{00064}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_af9208aee87634536a1a00cc1346d8b56_af9208aee87634536a1a00cc1346d8b56}{md<dim>::thread\_overdamped}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00065 \{}
\DoxyCodeLine{00070     memcpy(particles[i].xp,particles[i].x,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00071     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].dx[d]=-\/particles[i].F[d]/avars.overdamped\_gamma;}
\DoxyCodeLine{00072     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].x[d]+=integrator.h*particles[i].dx[d];}
\DoxyCodeLine{00073 \}}
\DoxyCodeLine{00074 }
\DoxyCodeLine{\Hypertarget{integrator_8md_8libmd_8cc_source_l00075}\mbox{\hyperlink{structmd_a7254ea0201ee881fd53c6722e6473e5f_a7254ea0201ee881fd53c6722e6473e5f}{00075}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_a7254ea0201ee881fd53c6722e6473e5f_a7254ea0201ee881fd53c6722e6473e5f}{md<dim>::integrate}}()}
\DoxyCodeLine{00076 \{}
\DoxyCodeLine{00081     avars.export\_force\_calc=\textcolor{keyword}{true};}
\DoxyCodeLine{00082     \textcolor{keywordflow}{switch}(integrator.method)}
\DoxyCodeLine{00083     \{}
\DoxyCodeLine{00084         \textcolor{keywordflow}{case} \mbox{\hyperlink{struct_i_n_t_e_g_r_a_t_o_r_aca72c4b4e70e5554ba92d83a6ffa1fbc_aca72c4b4e70e5554ba92d83a6ffa1fbcac2fcadec5c7709529f95c51206db881f}{INTEGRATOR::FO\_OVERDAMPED}}:}
\DoxyCodeLine{00085             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"integrating using overdamped first order (Euler)"});}
\DoxyCodeLine{00086             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_overdamped(i);}
\DoxyCodeLine{00087         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00088         \textcolor{keywordflow}{case} \mbox{\hyperlink{struct_i_n_t_e_g_r_a_t_o_r_aca72c4b4e70e5554ba92d83a6ffa1fbc_aca72c4b4e70e5554ba92d83a6ffa1fbcafb6551adf255abbef7111759da54d1a4}{INTEGRATOR::FO}}:}
\DoxyCodeLine{00089             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"integrating using first order (Euler)"});}
\DoxyCodeLine{00090             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_first\_order(i);}
\DoxyCodeLine{00091         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00092         \textcolor{keywordflow}{case} \mbox{\hyperlink{struct_i_n_t_e_g_r_a_t_o_r_aca72c4b4e70e5554ba92d83a6ffa1fbc_aca72c4b4e70e5554ba92d83a6ffa1fbca35688bfab06ce41823fd436dd67bcd62}{INTEGRATOR::VVERLET}}:}
\DoxyCodeLine{00093             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"integrating using symplectic Velocity Verlet"});}
\DoxyCodeLine{00094             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_vverlet\_x(i);}
\DoxyCodeLine{00095             recalc\_forces();}
\DoxyCodeLine{00096             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_vverlet\_dx(i);}
\DoxyCodeLine{00097         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00098         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00099             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"integrating using symplectic Euler method"});}
\DoxyCodeLine{00100             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_seuler(i);}
\DoxyCodeLine{00101         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00102     \}}
\DoxyCodeLine{00103     periodicity();}
\DoxyCodeLine{00104 \}}
\DoxyCodeLine{00105 }
\DoxyCodeLine{\Hypertarget{integrator_8md_8libmd_8cc_source_l00106}\mbox{\hyperlink{structmd_a9dfabbfd13fc5fb8d651edc7ad1ef293_a9dfabbfd13fc5fb8d651edc7ad1ef293}{00106}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_a9dfabbfd13fc5fb8d651edc7ad1ef293_a9dfabbfd13fc5fb8d651edc7ad1ef293}{md<dim>::timestep}}()}
\DoxyCodeLine{00107 \{}
\DoxyCodeLine{00112     \textcolor{keywordflow}{if}(simbox.useLshear)}
\DoxyCodeLine{00113     \{}
\DoxyCodeLine{00114         \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"updating boxshear boundaries"});}
\DoxyCodeLine{00115         update\_boundaries();}
\DoxyCodeLine{00116     \}}
\DoxyCodeLine{00117     calc\_forces();}
\DoxyCodeLine{00118     integrate();}
\DoxyCodeLine{00119     run\_hooks();}
\DoxyCodeLine{00120 \}}
\DoxyCodeLine{00121 }
\DoxyCodeLine{\Hypertarget{integrator_8md_8libmd_8cc_source_l00122}\mbox{\hyperlink{structmd_ab05795ae636fad01edb1eed8ce309ac6_ab05795ae636fad01edb1eed8ce309ac6}{00122}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_ab05795ae636fad01edb1eed8ce309ac6_ab05795ae636fad01edb1eed8ce309ac6}{md<dim>::timesteps}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k)}
\DoxyCodeLine{00123 \{}
\DoxyCodeLine{00128     \mbox{\hyperlink{macros_8libmd_8h_a75eb947f9b8c2f4fbec83008ec23e9ec_a75eb947f9b8c2f4fbec83008ec23e9ec}{DEBUG\_TIMER}}(\textcolor{stringliteral}{"start timesteps"});}
\DoxyCodeLine{00129     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<k;i++) timestep();}
\DoxyCodeLine{00130     \mbox{\hyperlink{macros_8libmd_8h_a75eb947f9b8c2f4fbec83008ec23e9ec_a75eb947f9b8c2f4fbec83008ec23e9ec}{DEBUG\_TIMER}}(\textcolor{stringliteral}{"stop timesteps"});}
\DoxyCodeLine{00131 \}}

\end{DoxyCode}
