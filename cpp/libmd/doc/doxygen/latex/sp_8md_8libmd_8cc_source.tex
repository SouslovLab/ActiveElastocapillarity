\hypertarget{sp_8md_8libmd_8cc_source}{}\doxysection{sp.\+md.\+libmd.\+cc}
\label{sp_8md_8libmd_8cc_source}\index{libmd-\/src/md/sp.md.libmd.cc@{libmd-\/src/md/sp.md.libmd.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00001}\mbox{\hyperlink{sp_8md_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}{00001}} \textcolor{preprocessor}{\#define \_\_libmd\_src\_file\_\_}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#ifndef libmd\_h}}
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include "../../libmd.h"}}
\DoxyCodeLine{00004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00005 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00006}\mbox{\hyperlink{structmd_a05ada8d55842d4cf7ae88bfe135cefda_a05ada8d55842d4cf7ae88bfe135cefda}{00006}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} \mbox{\hyperlink{structmd_a05ada8d55842d4cf7ae88bfe135cefda_a05ada8d55842d4cf7ae88bfe135cefda}{md<dim>::add\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} sptype)}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00011     \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi = network.superparticles.size();}
\DoxyCodeLine{00012     network.superparticles.push\_back(\mbox{\hyperlink{structsuperparticle}{superparticle}}());}
\DoxyCodeLine{00013     network.superparticles[spi].sptype = sptype;}
\DoxyCodeLine{00014     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"added superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" with type "} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi,sptype);}
\DoxyCodeLine{00015     \textcolor{keywordflow}{return} spi;}
\DoxyCodeLine{00016 \}}
\DoxyCodeLine{00017 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00018}\mbox{\hyperlink{structmd_a043c3e5e4b2b8b2d1eddcb48765b7d51_a043c3e5e4b2b8b2d1eddcb48765b7d51}{00018}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{bool} \mbox{\hyperlink{structmd_a043c3e5e4b2b8b2d1eddcb48765b7d51_a043c3e5e4b2b8b2d1eddcb48765b7d51}{md<dim>::rem\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi)}
\DoxyCodeLine{00019 \{}
\DoxyCodeLine{00026     \textcolor{keywordflow}{if}(spi>=network.superparticles.size())}
\DoxyCodeLine{00027     \{}
\DoxyCodeLine{00028         \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"superparticle \#\%d does not exist"}, spi);}
\DoxyCodeLine{00029         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00030     \}}
\DoxyCodeLine{00031     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00032     \{}
\DoxyCodeLine{00033         \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spn=network.superparticles.size()-\/1;}
\DoxyCodeLine{00034         \textcolor{keywordflow}{if}(spi<spn)}
\DoxyCodeLine{00035         \{}
\DoxyCodeLine{00036             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} m: network.superparticles[spn].particles) network.spid[m.first]=spi;}
\DoxyCodeLine{00037             iter\_swap(network.superparticles.begin()+spi,network.superparticles.rbegin());}
\DoxyCodeLine{00038         \}}
\DoxyCodeLine{00039         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} m: network.superparticles[spn].particles) network.spid[m.first]=\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}};}
\DoxyCodeLine{00040         network.superparticles.pop\_back();}
\DoxyCodeLine{00041         \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"removed superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00042         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00043     \}}
\DoxyCodeLine{00044 \}}
\DoxyCodeLine{00045 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00046}\mbox{\hyperlink{structmd_a0bed77514d85a9bd861546afa0af698b_a0bed77514d85a9bd861546afa0af698b}{00046}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{bool} \mbox{\hyperlink{structmd_a0bed77514d85a9bd861546afa0af698b_a0bed77514d85a9bd861546afa0af698b}{md<dim>::rem\_sp\_particles}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi)}
\DoxyCodeLine{00047 \{}
\DoxyCodeLine{00053     \textcolor{keywordflow}{if}(spi>=network.superparticles.size())}
\DoxyCodeLine{00054     \{}
\DoxyCodeLine{00055         \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"superparticle \#\%d does not exist"}, spi);}
\DoxyCodeLine{00056         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00057     \}}
\DoxyCodeLine{00058     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00059     \{}
\DoxyCodeLine{00060         \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;}
\DoxyCodeLine{00061         std::vector<ui> target(network.superparticles[spi].particles.size());}
\DoxyCodeLine{00062         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} m: network.superparticles[spi].particles) target[k++]=m.first;}
\DoxyCodeLine{00063         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} i: target) rem\_particle(i);}
\DoxyCodeLine{00064         network.superparticles[spi].particles.clear();}
\DoxyCodeLine{00065         network.superparticles[spi].backdoor.clear();}
\DoxyCodeLine{00066         \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"removed particles of superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00067         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00068     \}}
\DoxyCodeLine{00069 \}}
\DoxyCodeLine{00070 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00071}\mbox{\hyperlink{structmd_a1857afeac7bf05251c88d72840f696cd_a1857afeac7bf05251c88d72840f696cd}{00071}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} \mbox{\hyperlink{structmd_a1857afeac7bf05251c88d72840f696cd_a1857afeac7bf05251c88d72840f696cd}{md<dim>::sp\_ingest}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i,\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} idx)}
\DoxyCodeLine{00072 \{}
\DoxyCodeLine{00080     \textcolor{keywordflow}{if}(spi>=network.superparticles.size())}
\DoxyCodeLine{00081     \{}
\DoxyCodeLine{00082         \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"superparticle \#\%d does not exist"}, spi);}
\DoxyCodeLine{00083         \textcolor{keywordflow}{return} \mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}};}
\DoxyCodeLine{00084     \}}
\DoxyCodeLine{00085     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(network.spid[i] < \mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}})}
\DoxyCodeLine{00086     \{}
\DoxyCodeLine{00087         \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"particle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" is already in superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},i,network.spid[i]);}
\DoxyCodeLine{00088         \textcolor{keywordflow}{return} \mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}};}
\DoxyCodeLine{00089     \}}
\DoxyCodeLine{00090     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00091     \{}
\DoxyCodeLine{00092         \textcolor{keywordflow}{if}(idx>=network.superparticles[spi].backdoor.size())}
\DoxyCodeLine{00093         \{}
\DoxyCodeLine{00094             \textcolor{keywordflow}{if}(idx==\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}}) idx=network.superparticles[spi].backdoor.size();}
\DoxyCodeLine{00095             network.superparticles[spi].backdoor.resize(idx+1,\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}});}
\DoxyCodeLine{00096         \}}
\DoxyCodeLine{00097         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(network.superparticles[spi].backdoor[idx]<\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}})}
\DoxyCodeLine{00098         \{}
\DoxyCodeLine{00099             \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" already contains index \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi,idx);}
\DoxyCodeLine{00100             \textcolor{keywordflow}{return} \mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}};}
\DoxyCodeLine{00101         \}}
\DoxyCodeLine{00102         network.spid[i]=spi;}
\DoxyCodeLine{00103         network.superparticles[spi].backdoor[idx]=i;}
\DoxyCodeLine{00104         \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"particle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" is ingested by superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},i,spi);}
\DoxyCodeLine{00105         avars.reindex=\textcolor{keyword}{true};}
\DoxyCodeLine{00106         \textcolor{keywordflow}{return} network.superparticles[spi].particles[i]=idx;}
\DoxyCodeLine{00107     \}}
\DoxyCodeLine{00108 \}}
\DoxyCodeLine{00109 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00110}\mbox{\hyperlink{structmd_a3c6a1ca471afcd982bdf9a79217bfc70_a3c6a1ca471afcd982bdf9a79217bfc70}{00110}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{bool} \mbox{\hyperlink{structmd_a3c6a1ca471afcd982bdf9a79217bfc70_a3c6a1ca471afcd982bdf9a79217bfc70}{md<dim>::sp\_dispose}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00111 \{}
\DoxyCodeLine{00116     \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi=network.spid[i];}
\DoxyCodeLine{00117     \textcolor{keywordflow}{if}(spi==\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}}) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00118     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00119     \{}
\DoxyCodeLine{00120         network.spid[i]=\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}};}
\DoxyCodeLine{00121         \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"particle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" is removed from superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},i,spi);}
\DoxyCodeLine{00122         \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} j=network.superparticles[spi].particles[i];}
\DoxyCodeLine{00123         \textcolor{keywordflow}{if}(j==network.superparticles[spi].backdoor.size()-\/1)}
\DoxyCodeLine{00124         \{}
\DoxyCodeLine{00125             network.superparticles[spi].backdoor.pop\_back();}
\DoxyCodeLine{00126             \textcolor{keywordflow}{while}(!network.superparticles[spi].backdoor.empty() and network.superparticles[spi].backdoor.back()==\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}}) network.superparticles[spi].backdoor.pop\_back();}
\DoxyCodeLine{00127         \}}
\DoxyCodeLine{00128         \textcolor{keywordflow}{else} network.superparticles[spi].backdoor[j]=\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}};}
\DoxyCodeLine{00129         network.superparticles[spi].particles.erase(i);}
\DoxyCodeLine{00130         avars.reindex=\textcolor{keyword}{true};}
\DoxyCodeLine{00131         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00132     \}}
\DoxyCodeLine{00133 \}}
\DoxyCodeLine{00134 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00135}\mbox{\hyperlink{structmd_a6438fb0d8ee34d18868e40abb5e0fb7a_a6438fb0d8ee34d18868e40abb5e0fb7a}{00135}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{bool} \mbox{\hyperlink{structmd_a6438fb0d8ee34d18868e40abb5e0fb7a_a6438fb0d8ee34d18868e40abb5e0fb7a}{md<dim>::sp\_dispose\_idx}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} idx)}
\DoxyCodeLine{00136 \{}
\DoxyCodeLine{00142     \textcolor{keywordflow}{if}(spi>=network.superparticles.size())}
\DoxyCodeLine{00143     \{}
\DoxyCodeLine{00144         \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" does not exist"},spi);}
\DoxyCodeLine{00145         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00146     \}}
\DoxyCodeLine{00147     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(idx>=network.superparticles[spi].backdoor.size())}
\DoxyCodeLine{00148     \{}
\DoxyCodeLine{00149         \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" does not contain index \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi,idx);}
\DoxyCodeLine{00150         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00151     \}}
\DoxyCodeLine{00152     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00153     \{}
\DoxyCodeLine{00154         \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=network.superparticles[spi].backdoor[idx];}
\DoxyCodeLine{00155         \textcolor{keywordflow}{if}(i<\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}})}
\DoxyCodeLine{00156         \{}
\DoxyCodeLine{00157             sp\_dispose(i);}
\DoxyCodeLine{00158             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"particle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" is removed from superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},i,spi);}
\DoxyCodeLine{00159             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00160         \}}
\DoxyCodeLine{00161         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00162         \{}
\DoxyCodeLine{00163             \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" does not contain index \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi,idx);}
\DoxyCodeLine{00164             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00165         \}}
\DoxyCodeLine{00166     \}}
\DoxyCodeLine{00167 \}}
\DoxyCodeLine{00168 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00169}\mbox{\hyperlink{structmd_a2db2877593c6bf7fdf283d7a8a040602_a2db2877593c6bf7fdf283d7a8a040602}{00169}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} \mbox{\hyperlink{structmd_a2db2877593c6bf7fdf283d7a8a040602_a2db2877593c6bf7fdf283d7a8a040602}{md<dim>::sp\_pid}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} idx)}
\DoxyCodeLine{00170 \{}
\DoxyCodeLine{00175     \textcolor{keywordflow}{if}(spi>=network.superparticles.size())}
\DoxyCodeLine{00176     \{}
\DoxyCodeLine{00177         \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" does not exist"},spi);}
\DoxyCodeLine{00178         \textcolor{keywordflow}{return} \mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}};}
\DoxyCodeLine{00179     \}}
\DoxyCodeLine{00180     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(idx>=network.superparticles[spi].backdoor.size())}
\DoxyCodeLine{00181     \{}
\DoxyCodeLine{00182         \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" does not contain index \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi,idx);}
\DoxyCodeLine{00183         \textcolor{keywordflow}{return} \mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}};}
\DoxyCodeLine{00184     \}}
\DoxyCodeLine{00185     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} network.superparticles[spi].backdoor[idx];}
\DoxyCodeLine{00186 \}}
\DoxyCodeLine{00187 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00188}\mbox{\hyperlink{structmd_add37bc67284c75d605f1a15d6f38c1c9_add37bc67284c75d605f1a15d6f38c1c9}{00188}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_add37bc67284c75d605f1a15d6f38c1c9_add37bc67284c75d605f1a15d6f38c1c9}{md<dim>::fix\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\textcolor{keywordtype}{bool} fix)}
\DoxyCodeLine{00189 \{}
\DoxyCodeLine{00194     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"\%sfixing superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},fix?\textcolor{stringliteral}{""}:\textcolor{stringliteral}{"un"},spi);}
\DoxyCodeLine{00195     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it=network.superparticles[spi].particles.begin();it!=network.superparticles[spi].particles.end();it++) particles[it-\/>first].fix=fix;}
\DoxyCodeLine{00196 \}}
\DoxyCodeLine{00197 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00198}\mbox{\hyperlink{structmd_afa87cd3c320aca8244308b650a63b919_afa87cd3c320aca8244308b650a63b919}{00198}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} \mbox{\hyperlink{structmd_afa87cd3c320aca8244308b650a63b919_afa87cd3c320aca8244308b650a63b919}{md<dim>::clone\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x[dim])}
\DoxyCodeLine{00199 \{}
\DoxyCodeLine{00205     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"cloning superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00206     \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} retval=add\_sp(network.superparticles[spi].sptype);}
\DoxyCodeLine{00207     network.superparticles[retval].backdoor=network.superparticles[spi].backdoor;}
\DoxyCodeLine{00208     \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} K=network.superparticles[spi].backdoor.size(),i;}
\DoxyCodeLine{00209     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<K;k++)}
\DoxyCodeLine{00210     \{}
\DoxyCodeLine{00211         \textcolor{keywordflow}{if}((i=network.superparticles[spi].backdoor[k])<\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}})}
\DoxyCodeLine{00212         \{}
\DoxyCodeLine{00213             \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} p=clone\_particle(i,x);}
\DoxyCodeLine{00214             network.spid[p]=retval;}
\DoxyCodeLine{00215             network.superparticles[retval].particles[p]=k;}
\DoxyCodeLine{00216             network.superparticles[retval].backdoor[k]=p;}
\DoxyCodeLine{00217         \}}
\DoxyCodeLine{00218     \}}
\DoxyCodeLine{00219     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} f:network.forcelibrary) \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} u:f.particles) \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \&v:u) \textcolor{keywordflow}{if}(network.spid[v]==spi) v=network.superparticles[retval].backdoor[network.superparticles[spi].particles[v]];}
\DoxyCodeLine{00220     \textcolor{keywordflow}{return} retval;}
\DoxyCodeLine{00221 \}}
\DoxyCodeLine{00222 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00223}\mbox{\hyperlink{structmd_a528212f13bced99f7d50c5c21495591c_a528212f13bced99f7d50c5c21495591c}{00223}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_a528212f13bced99f7d50c5c21495591c_a528212f13bced99f7d50c5c21495591c}{md<dim>::translate\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x[dim])}
\DoxyCodeLine{00224 \{}
\DoxyCodeLine{00228     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"translating superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00229     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it=network.superparticles[spi].particles.begin();it!=network.superparticles[spi].particles.end();it++) translate\_particle(it-\/>first,x);}
\DoxyCodeLine{00230 \}}
\DoxyCodeLine{00231 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00232}\mbox{\hyperlink{structmd_abb7b161e967585126fd2c783ac67f6a3_abb7b161e967585126fd2c783ac67f6a3}{00232}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_abb7b161e967585126fd2c783ac67f6a3_abb7b161e967585126fd2c783ac67f6a3}{md<dim>::drift\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} dx[dim])}
\DoxyCodeLine{00233 \{}
\DoxyCodeLine{00237     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"drifting superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00238     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it=network.superparticles[spi].particles.begin();it!=network.superparticles[spi].particles.end();it++) drift\_particle(it-\/>first,dx);}
\DoxyCodeLine{00239 \}}
\DoxyCodeLine{00240 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00241}\mbox{\hyperlink{structmd_a88967703577f8f8ccc83f484dd5ef2c8_a88967703577f8f8ccc83f484dd5ef2c8}{00241}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_a88967703577f8f8ccc83f484dd5ef2c8_a88967703577f8f8ccc83f484dd5ef2c8}{md<dim>::heat\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} lambda)}
\DoxyCodeLine{00242 \{}
\DoxyCodeLine{00246     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"heating superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00247     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it=network.superparticles[spi].particles.begin();it!=network.superparticles[spi].particles.end();it++) drift\_particle(it-\/>first,lambda);}
\DoxyCodeLine{00248 \}}
\DoxyCodeLine{00249 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00250}\mbox{\hyperlink{structmd_ace0723e638c94d80c6706d46cc1e59ab_ace0723e638c94d80c6706d46cc1e59ab}{00250}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_ace0723e638c94d80c6706d46cc1e59ab_ace0723e638c94d80c6706d46cc1e59ab}{md<dim>::set\_position\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x[dim])}
\DoxyCodeLine{00251 \{}
\DoxyCodeLine{00255     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"repositioning superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00256     avars.export\_force\_calc=\textcolor{keyword}{true};}
\DoxyCodeLine{00257     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} delx[dim];}
\DoxyCodeLine{00258     get\_position\_sp(spi,delx);}
\DoxyCodeLine{00259     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) delx[d]=x[d]-\/delx[d];}
\DoxyCodeLine{00260     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it=network.superparticles[spi].particles.begin();it!=network.superparticles[spi].particles.end();it++) translate\_particle(it-\/>first,delx);}
\DoxyCodeLine{00261 \}}
\DoxyCodeLine{00262 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00263}\mbox{\hyperlink{structmd_ac064097ccc538e9671f65fe9fabb8af5_ac064097ccc538e9671f65fe9fabb8af5}{00263}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_ac064097ccc538e9671f65fe9fabb8af5_ac064097ccc538e9671f65fe9fabb8af5}{md<dim>::set\_velocity\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} dx[dim])}
\DoxyCodeLine{00264 \{}
\DoxyCodeLine{00268     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"setting velocity of superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00269     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it=network.superparticles[spi].particles.begin();it!=network.superparticles[spi].particles.end();it++) memcpy(particles[it-\/>first].dx,dx,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00270 \}}
\DoxyCodeLine{00271 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00272}\mbox{\hyperlink{structmd_a6e79e218504c7eb06be43e8919628d2c_a6e79e218504c7eb06be43e8919628d2c}{00272}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_a6e79e218504c7eb06be43e8919628d2c_a6e79e218504c7eb06be43e8919628d2c}{md<dim>::get\_position\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x[dim])}
\DoxyCodeLine{00273 \{}
\DoxyCodeLine{00277     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"calculating center of mass of superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00278     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} m=0.0;}
\DoxyCodeLine{00279     memset(x,0,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00280     \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=network.superparticles[spi].particles.begin()-\/>first;}
\DoxyCodeLine{00281     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it=network.superparticles[spi].particles.begin();it!=network.superparticles[spi].particles.end();it++)}
\DoxyCodeLine{00282     \{}
\DoxyCodeLine{00283         \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) x[d]+=particles[it-\/>first].m*dd(d,i,it-\/>first);}
\DoxyCodeLine{00284         m+=particles[it-\/>first].m;}
\DoxyCodeLine{00285     \}}
\DoxyCodeLine{00286     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) x[d]=particles[i].x[d]+x[d]/m;}
\DoxyCodeLine{00287     thread\_periodicity(x);}
\DoxyCodeLine{00288 \}}
\DoxyCodeLine{00289 }
\DoxyCodeLine{\Hypertarget{sp_8md_8libmd_8cc_source_l00290}\mbox{\hyperlink{structmd_ae7f5d74eeec366573b93ba6bf015c301_ae7f5d74eeec366573b93ba6bf015c301}{00290}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmd_ae7f5d74eeec366573b93ba6bf015c301_ae7f5d74eeec366573b93ba6bf015c301}{md<dim>::get\_velocity\_sp}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} spi,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} dx[dim])}
\DoxyCodeLine{00291 \{}
\DoxyCodeLine{00295     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"calculating velocity of center of mass of superparticle \#"} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},spi);}
\DoxyCodeLine{00296     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} m=0.0;}
\DoxyCodeLine{00297     memset(dx,0,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00298     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) dx[d]=0.0;}
\DoxyCodeLine{00299     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it=network.superparticles[spi].particles.begin();it!=network.superparticles[spi].particles.end();it++)}
\DoxyCodeLine{00300     \{}
\DoxyCodeLine{00301         \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) dx[d]+=particles[it-\/>first].m*particles[it-\/>first].dx[d];}
\DoxyCodeLine{00302         m+=particles[it-\/>first].m;}
\DoxyCodeLine{00303     \}}
\DoxyCodeLine{00304     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) dx[d]/=m;}
\DoxyCodeLine{00305 \}}

\end{DoxyCode}
