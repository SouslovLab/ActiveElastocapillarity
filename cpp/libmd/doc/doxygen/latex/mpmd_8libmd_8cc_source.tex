\hypertarget{mpmd_8libmd_8cc_source}{}\doxysection{mpmd.\+libmd.\+cc}
\label{mpmd_8libmd_8cc_source}\index{libmd-\/src/mpmd.libmd.cc@{libmd-\/src/mpmd.libmd.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00001}\mbox{\hyperlink{mpmd_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}{00001}} \textcolor{preprocessor}{\#define \_\_libmd\_src\_file\_\_}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#ifndef libmd\_h}}
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include "../libmd.h"}}
\DoxyCodeLine{00004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00005 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00006}\mbox{\hyperlink{structmpmd_a8d8a7f180f8b2bc1a009eda40285f1ac_a8d8a7f180f8b2bc1a009eda40285f1ac}{00006}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmpmd_a8d8a7f180f8b2bc1a009eda40285f1ac_a8d8a7f180f8b2bc1a009eda40285f1ac}{mpmd<dim>::embedded\_distsq}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} p1,\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} p2)}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00011     \textcolor{keywordflow}{return} distsq(p1,p2)+\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(patch.geometryx[p2].x-\/patch.geometryx[p1].x,2);}
\DoxyCodeLine{00012 \}}
\DoxyCodeLine{00013 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00014}\mbox{\hyperlink{structmpmd_ac66cf03a8c7039fd07981680b9b36f61_ac66cf03a8c7039fd07981680b9b36f61}{00014}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmpmd_a8d8a7f180f8b2bc1a009eda40285f1ac_a8d8a7f180f8b2bc1a009eda40285f1ac}{mpmd<dim>::embedded\_distsq}}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x1[dim],\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x2[dim])}
\DoxyCodeLine{00015 \{}
\DoxyCodeLine{00019     \textcolor{keywordflow}{return} distsq(x1,x2)+\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(patch.f(x2).x-\/patch.f(x1),2);}
\DoxyCodeLine{00020 \}}
\DoxyCodeLine{00021 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00022}\mbox{\hyperlink{structmpmd_ac63e3c2afe6cf48636858b95d94c14c7_ac63e3c2afe6cf48636858b95d94c14c7}{00022}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmpmd_a8d8a7f180f8b2bc1a009eda40285f1ac_a8d8a7f180f8b2bc1a009eda40285f1ac}{mpmd<dim>::embedded\_distsq}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} p1,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x2[dim])}
\DoxyCodeLine{00023 \{}
\DoxyCodeLine{00027     \textcolor{keywordflow}{return} distsq(p1,x2)+\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(patch.f(x2)-\/patch.geometryx[p1].x,2);}
\DoxyCodeLine{00028 \}}
\DoxyCodeLine{00029 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00030}\mbox{\hyperlink{structmpmd_a96b48b323ddc9f2d482516b3204118f0_a96b48b323ddc9f2d482516b3204118f0}{00030}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmpmd_a8d8a7f180f8b2bc1a009eda40285f1ac_a8d8a7f180f8b2bc1a009eda40285f1ac}{mpmd<dim>::embedded\_distsq}}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x1[dim],\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} p2)}
\DoxyCodeLine{00031 \{}
\DoxyCodeLine{00035     \textcolor{keywordflow}{return} distsq(x1,p2)+\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(patch.geometryx[p2].x-\/patch.f(x1),2);}
\DoxyCodeLine{00036 \}}
\DoxyCodeLine{00037 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00038}\mbox{\hyperlink{structmpmd_a15fd349a7f8147dc1c9bc8b74c15c0bd_a15fd349a7f8147dc1c9bc8b74c15c0bd}{00038}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmpmd_a15fd349a7f8147dc1c9bc8b74c15c0bd_a15fd349a7f8147dc1c9bc8b74c15c0bd}{mpmd<dim>::embedded\_dd\_p1}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d,\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} p1,\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} p2)}
\DoxyCodeLine{00039 \{}
\DoxyCodeLine{00044     \textcolor{keywordflow}{return} dd(d,p1,p2)+((patch.geometryx[p2].x-\/patch.geometryx[p1].x)*patch.geometryx[p1].dx[d]);}
\DoxyCodeLine{00045 \}}
\DoxyCodeLine{00046 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00047}\mbox{\hyperlink{structmpmd_a8847e2690ac1f322b49c2f5f5389c013_a8847e2690ac1f322b49c2f5f5389c013}{00047}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmpmd_a8847e2690ac1f322b49c2f5f5389c013_a8847e2690ac1f322b49c2f5f5389c013}{mpmd<dim>::embedded\_dd\_p2}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d,\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} p1,\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} p2)}
\DoxyCodeLine{00048 \{}
\DoxyCodeLine{00053     \textcolor{keywordflow}{return} dd(d,p2,p1)+((patch.geometryx[p1].x-\/patch.geometryx[p2].x)*patch.geometryx[p2].dx[d]);}
\DoxyCodeLine{00054 \}}
\DoxyCodeLine{00055 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00056}\mbox{\hyperlink{structmpmd_a0f07f1bb38ae54ee286bd1d1223b59e9_a0f07f1bb38ae54ee286bd1d1223b59e9}{00056}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_a0f07f1bb38ae54ee286bd1d1223b59e9_a0f07f1bb38ae54ee286bd1d1223b59e9}{mpmd<dim>::zuiden\_C}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} ZC[dim])}
\DoxyCodeLine{00057 \{}
\DoxyCodeLine{00062     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} C[dim]=\{\};}
\DoxyCodeLine{00063     memset(ZC,0,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00064     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} sigma=0;sigma<dim;sigma++) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} mu=0;mu<dim;mu++) C[sigma]+=patch.gp(i,sigma,mu)*(particles[i].x[mu]-\/particles[i].xp[mu]);}
\DoxyCodeLine{00065     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} sigma=0;sigma<dim;sigma++) C[sigma]+=\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(integrator.h,2)*particles[i].F[sigma]/particles[i].m;}
\DoxyCodeLine{00066     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} rho=0;rho<dim;rho++) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} sigma=0;sigma<dim;sigma++) ZC[rho]+=patch.ginv(i,rho,sigma)*C[sigma];}
\DoxyCodeLine{00067 \}}
\DoxyCodeLine{00068 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00069}\mbox{\hyperlink{structmpmd_aa7e40e24a8575a14dc7c1546010a7c68_aa7e40e24a8575a14dc7c1546010a7c68}{00069}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_aa7e40e24a8575a14dc7c1546010a7c68_aa7e40e24a8575a14dc7c1546010a7c68}{mpmd<dim>::zuiden\_A}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} eps[dim])}
\DoxyCodeLine{00070 \{}
\DoxyCodeLine{00075     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} ZA[dim]=\{\};}
\DoxyCodeLine{00076     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} rho=0;rho<dim;rho++) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} sigma=0;sigma<dim;sigma++) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} mu=0;mu<dim;mu++) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} nu=0;nu<dim;nu++) ZA[rho]+=patch.ginv(i,rho,sigma)*patch.A(i,sigma,mu,nu)*eps[mu]*eps[nu];}
\DoxyCodeLine{00077     memcpy(eps,ZA,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00078 \}}
\DoxyCodeLine{00079 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00080}\mbox{\hyperlink{structmpmd_a8fc7bd10d9db7db29770d6d53d094e44_a8fc7bd10d9db7db29770d6d53d094e44}{00080}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_a8fc7bd10d9db7db29770d6d53d094e44_a8fc7bd10d9db7db29770d6d53d094e44}{mpmd<dim>::thread\_zuiden\_wfi}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00081 \{}
\DoxyCodeLine{00085     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} eps[dim]=\{\};}
\DoxyCodeLine{00086     zuiden\_C(i,eps);}
\DoxyCodeLine{00087     memcpy(particles[i].xp,particles[i].x,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00088     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].x[d]+=eps[d];}
\DoxyCodeLine{00089     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].dx[d]=eps[d]/integrator.h;}
\DoxyCodeLine{00090 \}}
\DoxyCodeLine{00091 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00092}\mbox{\hyperlink{structmpmd_a8e7d1b7cafc905e283023a6b822cc766_a8e7d1b7cafc905e283023a6b822cc766}{00092}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_a8e7d1b7cafc905e283023a6b822cc766_a8e7d1b7cafc905e283023a6b822cc766}{mpmd<dim>::thread\_zuiden\_protect}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00093 \{}
\DoxyCodeLine{00098     \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} counter=0;}
\DoxyCodeLine{00099     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} ZC[dim],eps[dim],epsp[dim],val;}
\DoxyCodeLine{00100     zuiden\_C(i,ZC);}
\DoxyCodeLine{00101     memcpy(eps,ZC,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00102     \textcolor{keywordflow}{do}}
\DoxyCodeLine{00103     \{}
\DoxyCodeLine{00104         val=0.0;}
\DoxyCodeLine{00105         counter++;}
\DoxyCodeLine{00106         memcpy(epsp,eps,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00107         zuiden\_A(i,eps);}
\DoxyCodeLine{00108         \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) eps[d]+=ZC[d];}
\DoxyCodeLine{00109         \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) val+=\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(epsp[d]-\/eps[d]);}
\DoxyCodeLine{00110         \mbox{\hyperlink{macros_8libmd_8h_afefca75c5eec58a9b2f18b25a8b649b5_afefca75c5eec58a9b2f18b25a8b649b5}{DEBUG\_3}}(\textcolor{stringliteral}{"fixed point iterators cycle: "} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{""},counter);}
\DoxyCodeLine{00111     \}}
\DoxyCodeLine{00112     \textcolor{keywordflow}{while}(counter<integrator.generations and val>std::numeric\_limits<ldf>::epsilon());}
\DoxyCodeLine{00113     memcpy(particles[i].xp,particles[i].x,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00114     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].x[d]+=eps[d];}
\DoxyCodeLine{00115     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].dx[d]=eps[d]/integrator.h;}
\DoxyCodeLine{00116 \}}
\DoxyCodeLine{00117 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00118}\mbox{\hyperlink{structmpmd_a47eee1cf060ce915bb077ac558fb762c_a47eee1cf060ce915bb077ac558fb762c}{00118}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_a47eee1cf060ce915bb077ac558fb762c_a47eee1cf060ce915bb077ac558fb762c}{mpmd<dim>::thread\_zuiden}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00119 \{}
\DoxyCodeLine{00124     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} ZC[dim],eps[dim],epsp[dim],val;}
\DoxyCodeLine{00125     zuiden\_C(i,ZC);}
\DoxyCodeLine{00126     memcpy(eps,ZC,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00127     \textcolor{keywordflow}{do}}
\DoxyCodeLine{00128     \{}
\DoxyCodeLine{00129         val=0.0;}
\DoxyCodeLine{00130         memcpy(epsp,eps,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00131         zuiden\_A(i,eps);}
\DoxyCodeLine{00132         \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) eps[d]+=ZC[d];}
\DoxyCodeLine{00133         \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) val+=\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(epsp[d]-\/eps[d]);}
\DoxyCodeLine{00134     \}}
\DoxyCodeLine{00135     \textcolor{keywordflow}{while}(val>std::numeric\_limits<ldf>::epsilon());}
\DoxyCodeLine{00136     memcpy(particles[i].xp,particles[i].x,dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00137     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].x[d]+=eps[d];}
\DoxyCodeLine{00138     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].dx[d]=eps[d]/integrator.h;}
\DoxyCodeLine{00139 \}}
\DoxyCodeLine{00140 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00141}\mbox{\hyperlink{structmpmd_a9aae6c4551ae89f9ecadfff6755e75ca_a9aae6c4551ae89f9ecadfff6755e75ca}{00141}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_a9aae6c4551ae89f9ecadfff6755e75ca_a9aae6c4551ae89f9ecadfff6755e75ca}{mpmd<dim>::thread\_history}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00142 \{}
\DoxyCodeLine{00146     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) particles[i].xp[d]=particles[i].x[d]-\/particles[i].dx[d]*integrator.h;}
\DoxyCodeLine{00147 \}}
\DoxyCodeLine{00148 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00149}\mbox{\hyperlink{structmpmd_aacb392a8e756a069870b388a189485b0_aacb392a8e756a069870b388a189485b0}{00149}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_aacb392a8e756a069870b388a189485b0_aacb392a8e756a069870b388a189485b0}{mpmd<dim>::history}}()}
\DoxyCodeLine{00150 \{}
\DoxyCodeLine{00155     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) thread\_history(i);}
\DoxyCodeLine{00156     patch.geometryx.resize(N);}
\DoxyCodeLine{00157     patch.geometryxp.resize(N);}
\DoxyCodeLine{00158     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) patch.calc(patch.geometryxp[i],particles[i].xp);}
\DoxyCodeLine{00159     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) patch.calc(i,particles[i].x);}
\DoxyCodeLine{00160 \}}
\DoxyCodeLine{00161 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00162}\mbox{\hyperlink{structmpmd_a7e1ceda4892e4a680231e116f23937e9_a7e1ceda4892e4a680231e116f23937e9}{00162}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_a7e1ceda4892e4a680231e116f23937e9_a7e1ceda4892e4a680231e116f23937e9}{mpmd<dim>::thread\_calc\_geometry}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00163 \{}
\DoxyCodeLine{00167     patch.calc(i,particles[i].x);}
\DoxyCodeLine{00168 \}}
\DoxyCodeLine{00169 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00170}\mbox{\hyperlink{structmpmd_a1548ce998855a5d2b559001334cb5de7_a1548ce998855a5d2b559001334cb5de7}{00170}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_a1548ce998855a5d2b559001334cb5de7_a1548ce998855a5d2b559001334cb5de7}{mpmd<dim>::calc\_geometry}}()}
\DoxyCodeLine{00171 \{}
\DoxyCodeLine{00175     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) thread\_calc\_geometry(i);}
\DoxyCodeLine{00176 \}}
\DoxyCodeLine{00177 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00178}\mbox{\hyperlink{structmpmd_a13769566d0f591f1a5bdacea665aaf59_a13769566d0f591f1a5bdacea665aaf59}{00178}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_a13769566d0f591f1a5bdacea665aaf59_a13769566d0f591f1a5bdacea665aaf59}{mpmd<dim>::mp\_thread\_calc\_pot\_forces}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00179 \{}
\DoxyCodeLine{00183     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} sij: network.skins[i]) \textcolor{keywordflow}{if}(i>sij.neighbor)}
\DoxyCodeLine{00184     \{}
\DoxyCodeLine{00185         \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} rsq=embedded\_distsq(i,sij.neighbor);}
\DoxyCodeLine{00186         \textcolor{keywordflow}{if}(!network.update or rsq<\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(get\_rco(sij.interaction),2))}
\DoxyCodeLine{00187         \{}
\DoxyCodeLine{00188             \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} r=\mbox{\hyperlink{autodiff_8libmd_8cc_af33bda4d5a7fc8ad1679ec339a730045_af33bda4d5a7fc8ad1679ec339a730045}{std::sqrt}}(rsq);}
\DoxyCodeLine{00189             \mbox{\hyperlink{macros_8libmd_8h_afefca75c5eec58a9b2f18b25a8b649b5_afefca75c5eec58a9b2f18b25a8b649b5}{DEBUG\_3}}(\textcolor{stringliteral}{"r = "} \mbox{\hyperlink{libmd_8h_aeae5d38344bd9746908a939e55a8442e_aeae5d38344bd9746908a939e55a8442e}{F\_LDF}},r);}
\DoxyCodeLine{00190             \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} dVdr=v.dr(network.library[sij.interaction].potential,r,network.library[sij.interaction].parameters);}
\DoxyCodeLine{00191             \mbox{\hyperlink{macros_8libmd_8h_afefca75c5eec58a9b2f18b25a8b649b5_afefca75c5eec58a9b2f18b25a8b649b5}{DEBUG\_3}}(\textcolor{stringliteral}{"dV/dr = "} \mbox{\hyperlink{libmd_8h_aeae5d38344bd9746908a939e55a8442e_aeae5d38344bd9746908a939e55a8442e}{F\_LDF}},dVdr);}
\DoxyCodeLine{00192             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++)}
\DoxyCodeLine{00193             \{}
\DoxyCodeLine{00194                 particles[i].F[d]+=embedded\_dd\_p1(d,i,sij.neighbor)*dVdr/r;}
\DoxyCodeLine{00195                 \mbox{\hyperlink{macros_8libmd_8h_afefca75c5eec58a9b2f18b25a8b649b5_afefca75c5eec58a9b2f18b25a8b649b5}{DEBUG\_3}}(\textcolor{stringliteral}{"particles["} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{"].F["} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{"] = "} \mbox{\hyperlink{libmd_8h_aeae5d38344bd9746908a939e55a8442e_aeae5d38344bd9746908a939e55a8442e}{F\_LDF}},i,d,embedded\_dd\_p1(d,i,sij.neighbor)*dVdr/r);}
\DoxyCodeLine{00196                 particles[sij.neighbor].F[d]+=embedded\_dd\_p2(d,i,sij.neighbor)*dVdr/r;}
\DoxyCodeLine{00197                 \mbox{\hyperlink{macros_8libmd_8h_afefca75c5eec58a9b2f18b25a8b649b5_afefca75c5eec58a9b2f18b25a8b649b5}{DEBUG\_3}}(\textcolor{stringliteral}{"particles["} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{"].F["} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{"] = "} \mbox{\hyperlink{libmd_8h_aeae5d38344bd9746908a939e55a8442e_aeae5d38344bd9746908a939e55a8442e}{F\_LDF}},sij.neighbor,d,embedded\_dd\_p2(d,i,sij.neighbor)*dVdr/r);}
\DoxyCodeLine{00198             \}}
\DoxyCodeLine{00199         \}}
\DoxyCodeLine{00200     \}}
\DoxyCodeLine{00201 \}}
\DoxyCodeLine{00202 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00203}\mbox{\hyperlink{structmpmd_acaff47ed55f39e95d3febf8487b93a9b_acaff47ed55f39e95d3febf8487b93a9b}{00203}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_acaff47ed55f39e95d3febf8487b93a9b_acaff47ed55f39e95d3febf8487b93a9b}{mpmd<dim>::calc\_forces}}()}
\DoxyCodeLine{00204 \{}
\DoxyCodeLine{00208     \textcolor{keywordflow}{if}(network.update and (avars.reindex or test\_index()))}
\DoxyCodeLine{00209     \{}
\DoxyCodeLine{00210         \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"regenerating skinlist"});}
\DoxyCodeLine{00211         index();}
\DoxyCodeLine{00212     \}}
\DoxyCodeLine{00213     \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"exec is here"});}
\DoxyCodeLine{00214     avars.export\_force\_calc=\textcolor{keyword}{false};}
\DoxyCodeLine{00215     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) thread\_clear\_forces(i);}
\DoxyCodeLine{00216     recalc\_forces();}
\DoxyCodeLine{00217 \}}
\DoxyCodeLine{00218 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00219}\mbox{\hyperlink{structmpmd_a56359315b7b7cd836dbff7614ceb1c96_a56359315b7b7cd836dbff7614ceb1c96}{00219}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_a56359315b7b7cd836dbff7614ceb1c96_a56359315b7b7cd836dbff7614ceb1c96}{mpmd<dim>::recalc\_forces}}()}
\DoxyCodeLine{00220 \{}
\DoxyCodeLine{00224     \mbox{\hyperlink{macros_8libmd_8h_afefca75c5eec58a9b2f18b25a8b649b5_afefca75c5eec58a9b2f18b25a8b649b5}{DEBUG\_3}}(\textcolor{stringliteral}{"exec is here"});}
\DoxyCodeLine{00225     \textcolor{keywordflow}{if}(!network.library.empty()) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) mp\_thread\_calc\_pot\_forces(i);}
\DoxyCodeLine{00226     \textcolor{keywordflow}{if}(!network.forcelibrary.empty()) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) thread\_calc\_ext\_forces(i);}
\DoxyCodeLine{00227 \}}
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00228}\mbox{\hyperlink{structmpmd_afdb6c81bc049485c05ed952728a27312_afdb6c81bc049485c05ed952728a27312}{00228}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_afdb6c81bc049485c05ed952728a27312_afdb6c81bc049485c05ed952728a27312}{mpmd<dim>::integrate}}()}
\DoxyCodeLine{00229 \{}
\DoxyCodeLine{00234     avars.export\_force\_calc=\textcolor{keyword}{true};}
\DoxyCodeLine{00235     \textcolor{keywordflow}{switch}(integrator.method)}
\DoxyCodeLine{00236     \{}
\DoxyCodeLine{00237         \textcolor{keywordflow}{case} \mbox{\hyperlink{struct_m_p___i_n_t_e_g_r_a_t_o_r_a6d6719917c0d2a6ffd3f204711ee6397_a6d6719917c0d2a6ffd3f204711ee6397a7782ad9649ae9bc647269a89229b7ab6}{MP\_INTEGRATOR::VVERLET}}:}
\DoxyCodeLine{00238             \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"flatspace integrator"});}
\DoxyCodeLine{00239             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"integrating using flatspace velocity Verlet"});}
\DoxyCodeLine{00240             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_vverlet\_x(i);}
\DoxyCodeLine{00241             recalc\_forces();}
\DoxyCodeLine{00242             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_vverlet\_dx(i);}
\DoxyCodeLine{00243         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00244         \textcolor{keywordflow}{case} \mbox{\hyperlink{struct_m_p___i_n_t_e_g_r_a_t_o_r_a6d6719917c0d2a6ffd3f204711ee6397_a6d6719917c0d2a6ffd3f204711ee6397a0c573419215cd00cd3d6ab778fe897a8}{MP\_INTEGRATOR::SEULER}}:}
\DoxyCodeLine{00245             \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"flatspace integrator"});}
\DoxyCodeLine{00246             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"integrating using flatspace symplectic Euler"});}
\DoxyCodeLine{00247             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_seuler(i);}
\DoxyCodeLine{00248         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00249         \textcolor{keywordflow}{case} \mbox{\hyperlink{struct_m_p___i_n_t_e_g_r_a_t_o_r_a6d6719917c0d2a6ffd3f204711ee6397_a6d6719917c0d2a6ffd3f204711ee6397a236a12fc2c2f110433ea3cbd6000e2f5}{MP\_INTEGRATOR::VZ\_WFI}}:}
\DoxyCodeLine{00250             \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"incomplete integrator"});}
\DoxyCodeLine{00251             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"integrating using van Zuiden without fixed point iterations"});}
\DoxyCodeLine{00252             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_zuiden\_wfi(i);}
\DoxyCodeLine{00253         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00254         \textcolor{keywordflow}{case} \mbox{\hyperlink{struct_m_p___i_n_t_e_g_r_a_t_o_r_a6d6719917c0d2a6ffd3f204711ee6397_a6d6719917c0d2a6ffd3f204711ee6397a4bc858ca6ee88e07401dd1d915c4001e}{MP\_INTEGRATOR::VZ\_P}}:}
\DoxyCodeLine{00255             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"integrating using van Zuiden with protected (with "} \mbox{\hyperlink{libmd_8h_a0912422c5c51b0116165d1714a0a56a7_a0912422c5c51b0116165d1714a0a56a7}{F\_UI}} \textcolor{stringliteral}{" generations) fixed point iterations"},integrator.generations);}
\DoxyCodeLine{00256             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_zuiden\_protect(i);}
\DoxyCodeLine{00257         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00258         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00259             \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"integrating using van Zuiden"});}
\DoxyCodeLine{00260             \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) \textcolor{keywordflow}{if}(!particles[i].fix) thread\_zuiden(i);}
\DoxyCodeLine{00261         \textcolor{keywordflow}{break};}
\DoxyCodeLine{00262     \}}
\DoxyCodeLine{00263     periodicity();}
\DoxyCodeLine{00264     patch.geometryxp=patch.geometryx;}
\DoxyCodeLine{00265     calc\_geometry();}
\DoxyCodeLine{00266 \}}
\DoxyCodeLine{00267 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00268}\mbox{\hyperlink{structmpmd_a4c7964dc3b819ca6c84a4df6781ac303_a4c7964dc3b819ca6c84a4df6781ac303}{00268}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmpmd_a4c7964dc3b819ca6c84a4df6781ac303_a4c7964dc3b819ca6c84a4df6781ac303}{mpmd<dim>::thread\_T}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00269 \{}
\DoxyCodeLine{00273     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} retval=0.0;}
\DoxyCodeLine{00274     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} mu=0;mu<dim;mu++) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} nu=0;nu<dim;nu++) retval+=patch.g(i,mu,nu)*particles[i].dx[mu]*particles[i].dx[nu];}
\DoxyCodeLine{00275     \textcolor{keywordflow}{return} 0.5*particles[i].m*retval;}
\DoxyCodeLine{00276 \}}
\DoxyCodeLine{00277 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00278}\mbox{\hyperlink{structmpmd_acaf1bb37ff9ca7c2b6db0093478dfb94_acaf1bb37ff9ca7c2b6db0093478dfb94}{00278}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmpmd_acaf1bb37ff9ca7c2b6db0093478dfb94_acaf1bb37ff9ca7c2b6db0093478dfb94}{mpmd<dim>::thread\_V}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i,\textcolor{keywordtype}{bool} higher\_index\_only)}
\DoxyCodeLine{00279 \{}
\DoxyCodeLine{00283     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} retval=0.0;}
\DoxyCodeLine{00284     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} rcosq=\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(network.rco,2);}
\DoxyCodeLine{00285     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} sij: network.skins[i]) \textcolor{keywordflow}{if}(!higher\_index\_only or i<sij.neighbor)}
\DoxyCodeLine{00286     \{}
\DoxyCodeLine{00287         \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} rsq=embedded\_distsq(i,sij.neighbor);}
\DoxyCodeLine{00288         \textcolor{keywordflow}{if}(rsq<rcosq)}
\DoxyCodeLine{00289         \{}
\DoxyCodeLine{00290             \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} r=\mbox{\hyperlink{autodiff_8libmd_8cc_af33bda4d5a7fc8ad1679ec339a730045_af33bda4d5a7fc8ad1679ec339a730045}{std::sqrt}}(rsq);}
\DoxyCodeLine{00291             retval+=v(network.library[sij.interaction].potential,r,network.library[sij.interaction].parameters);}
\DoxyCodeLine{00292             \textcolor{keywordflow}{if}(network.update) retval-\/=network.library[sij.interaction].vco;}
\DoxyCodeLine{00293         \}}
\DoxyCodeLine{00294     \}}
\DoxyCodeLine{00295     \textcolor{keywordflow}{return} retval;}
\DoxyCodeLine{00296 \}}
\DoxyCodeLine{00297 }
\DoxyCodeLine{\Hypertarget{mpmd_8libmd_8cc_source_l00298}\mbox{\hyperlink{structmpmd_ad368a836ece2eeb2bc5896695b9cf886_ad368a836ece2eeb2bc5896695b9cf886}{00298}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{structmpmd_ad368a836ece2eeb2bc5896695b9cf886_ad368a836ece2eeb2bc5896695b9cf886}{mpmd<dim>::set\_langevin}}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} T,\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} gamma)}
\DoxyCodeLine{00299 \{}
\DoxyCodeLine{00303     \textcolor{keywordflow}{if}(avars.noftypelangevin==\mbox{\hyperlink{libmd_8h_a027c70e4468b8d7fb673dec474df6902_a027c70e4468b8d7fb673dec474df6902}{UI\_MAX}})}
\DoxyCodeLine{00304     \{}
\DoxyCodeLine{00305         \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"activating langevin (mp) thermostat with temperature: "} \mbox{\hyperlink{libmd_8h_aeae5d38344bd9746908a939e55a8442e_aeae5d38344bd9746908a939e55a8442e}{F\_LDF}} \textcolor{stringliteral}{" and damping coefficient: "} \mbox{\hyperlink{libmd_8h_aeae5d38344bd9746908a939e55a8442e_aeae5d38344bd9746908a939e55a8442e}{F\_LDF}},T,gamma);}
\DoxyCodeLine{00306         std::vector<ldf> parameters=\{T,gamma\};}
\DoxyCodeLine{00307         avars.noftypelangevin=add\_forcetype(\mbox{\hyperlink{struct_e_x_t_f_o_r_c_e_ae0d69b9865d5f695184b9bd5bb549414_ae0d69b9865d5f695184b9bd5bb549414a89f501183c7294adb0e2ef37757a358b}{EXTFORCE::LANGEVIN\_MP}},parameters);}
\DoxyCodeLine{00308         assign\_all\_forcetype(avars.noftypelangevin);}
\DoxyCodeLine{00309         set\_damping(gamma);}
\DoxyCodeLine{00310     \}}
\DoxyCodeLine{00311     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00312     \{}
\DoxyCodeLine{00313         \mbox{\hyperlink{macros_8libmd_8h_acbe5e8b99e25562e699538dea76d37fa_acbe5e8b99e25562e699538dea76d37fa}{DEBUG\_2}}(\textcolor{stringliteral}{"modifying langevin (mp) coefficient T to: "} \mbox{\hyperlink{libmd_8h_aeae5d38344bd9746908a939e55a8442e_aeae5d38344bd9746908a939e55a8442e}{F\_LDF}} \textcolor{stringliteral}{" and gamma to: "} \mbox{\hyperlink{libmd_8h_aeae5d38344bd9746908a939e55a8442e_aeae5d38344bd9746908a939e55a8442e}{F\_LDF}},T,gamma);}
\DoxyCodeLine{00314         network.forcelibrary[avars.noftypedamping].parameters[0]=T;}
\DoxyCodeLine{00315         network.forcelibrary[avars.noftypedamping].parameters[0]=gamma;}
\DoxyCodeLine{00316         set\_damping(gamma);}
\DoxyCodeLine{00317     \}}
\DoxyCodeLine{00318 \}}

\end{DoxyCode}
