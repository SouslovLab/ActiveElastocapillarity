\hypertarget{potentials_8libmd_8cc_source}{}\doxysection{potentials.\+libmd.\+cc}
\label{potentials_8libmd_8cc_source}\index{libmd-\/src/potentials.libmd.cc@{libmd-\/src/potentials.libmd.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{potentials_8libmd_8cc_source_l00001}\mbox{\hyperlink{potentials_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}{00001}} \textcolor{preprocessor}{\#define \_\_libmd\_src\_file\_\_}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#ifndef libmd\_h}}
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include "../libmd.h"}}
\DoxyCodeLine{00004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00005 }
\DoxyCodeLine{\Hypertarget{potentials_8libmd_8cc_source_l00006}\mbox{\hyperlink{libmd_8h_ad848edbfe46941489261f84096adb972_ad848edbfe46941489261f84096adb972}{00006}} \textcolor{keyword}{template}<\textcolor{keyword}{class} X> X \mbox{\hyperlink{potentials_8libmd_8cc_ad848edbfe46941489261f84096adb972_ad848edbfe46941489261f84096adb972}{COULOMB}}(X r,std::vector<ldf> \&parameters)}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00016     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} q=parameters[0];}
\DoxyCodeLine{00017     \textcolor{keywordflow}{return} q/r;}
\DoxyCodeLine{00018 \}}
\DoxyCodeLine{00019 }
\DoxyCodeLine{\Hypertarget{potentials_8libmd_8cc_source_l00020}\mbox{\hyperlink{libmd_8h_af54e62e12e037d8b70bfd88d71fe23a9_af54e62e12e037d8b70bfd88d71fe23a9}{00020}} \textcolor{keyword}{template}<\textcolor{keyword}{class} X> X \mbox{\hyperlink{potentials_8libmd_8cc_af54e62e12e037d8b70bfd88d71fe23a9_af54e62e12e037d8b70bfd88d71fe23a9}{YUKAWA}}(X r,std::vector<ldf> \&parameters)}
\DoxyCodeLine{00021 \{}
\DoxyCodeLine{00031     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} b=parameters[0];}
\DoxyCodeLine{00032     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} k=parameters[1];}
\DoxyCodeLine{00033     \textcolor{keywordflow}{return} b/(r*\mbox{\hyperlink{autodiff_8libmd_8cc_ade909d25ab24d31221b8640c8c6e58c3_ade909d25ab24d31221b8640c8c6e58c3}{exp}}(k*r));}
\DoxyCodeLine{00034 \}}
\DoxyCodeLine{00035 }
\DoxyCodeLine{\Hypertarget{potentials_8libmd_8cc_source_l00036}\mbox{\hyperlink{libmd_8h_a82eec3e4535cd60b73051cf9970be606_a82eec3e4535cd60b73051cf9970be606}{00036}} \textcolor{keyword}{template}<\textcolor{keyword}{class} X> X \mbox{\hyperlink{potentials_8libmd_8cc_a82eec3e4535cd60b73051cf9970be606_a82eec3e4535cd60b73051cf9970be606}{HOOKEAN}}(X r,std::vector<ldf> \&parameters)}
\DoxyCodeLine{00037 \{}
\DoxyCodeLine{00047     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} k=parameters[0];}
\DoxyCodeLine{00048     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} r0=parameters[1];}
\DoxyCodeLine{00049     \textcolor{keywordflow}{return} k/2.0*\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{pow}}(r-\/r0,2);}
\DoxyCodeLine{00050 \}}
\DoxyCodeLine{00051 }
\DoxyCodeLine{\Hypertarget{potentials_8libmd_8cc_source_l00052}\mbox{\hyperlink{libmd_8h_a2d9694d9eebcc0fcc8245d5fe107ab44_a2d9694d9eebcc0fcc8245d5fe107ab44}{00052}} \textcolor{keyword}{template}<\textcolor{keyword}{class} X> X \mbox{\hyperlink{potentials_8libmd_8cc_a2d9694d9eebcc0fcc8245d5fe107ab44_a2d9694d9eebcc0fcc8245d5fe107ab44}{LJ}}(X r,std::vector<ldf> \&parameters)}
\DoxyCodeLine{00053 \{}
\DoxyCodeLine{00063     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} e=parameters[0];}
\DoxyCodeLine{00064     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} s=parameters[1];}
\DoxyCodeLine{00065     \textcolor{keywordflow}{return} 4.0*e*(\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{pow}}(s/r,12)-\/\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{pow}}(s/r,6));}
\DoxyCodeLine{00066 \}}
\DoxyCodeLine{00067 }
\DoxyCodeLine{\Hypertarget{potentials_8libmd_8cc_source_l00068}\mbox{\hyperlink{libmd_8h_a3f9ca49430b0d735c6547b4c36d3fe29_a3f9ca49430b0d735c6547b4c36d3fe29}{00068}} \textcolor{keyword}{template}<\textcolor{keyword}{class} X> X \mbox{\hyperlink{potentials_8libmd_8cc_a3f9ca49430b0d735c6547b4c36d3fe29_a3f9ca49430b0d735c6547b4c36d3fe29}{MORSE}}(X r,std::vector<ldf> \&parameters)}
\DoxyCodeLine{00069 \{}
\DoxyCodeLine{00080     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} d=parameters[0];}
\DoxyCodeLine{00081     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} a=parameters[1];}
\DoxyCodeLine{00082     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} re=parameters[2];}
\DoxyCodeLine{00083     \textcolor{keywordflow}{return} d*\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{pow}}(1.0-\/\mbox{\hyperlink{autodiff_8libmd_8cc_ade909d25ab24d31221b8640c8c6e58c3_ade909d25ab24d31221b8640c8c6e58c3}{exp}}(a*(re-\/r)),2);}
\DoxyCodeLine{00084 \}}
\DoxyCodeLine{00085 }
\DoxyCodeLine{\Hypertarget{potentials_8libmd_8cc_source_l00086}\mbox{\hyperlink{libmd_8h_a082699d879383d5964f469bd32984224_a082699d879383d5964f469bd32984224}{00086}} \textcolor{keyword}{template}<\textcolor{keyword}{class} X> X \mbox{\hyperlink{potentials_8libmd_8cc_a082699d879383d5964f469bd32984224_a082699d879383d5964f469bd32984224}{FORCEDIPOLE}}(X r,std::vector<ldf> \&parameters)}
\DoxyCodeLine{00087 \{}
\DoxyCodeLine{00088     \textcolor{comment}{// exerts a constant force f = parameters[0]. Positive force => extension of dipole}}
\DoxyCodeLine{00089     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} f = parameters[0];}
\DoxyCodeLine{00090     \textcolor{keywordflow}{return} -\/f*r;}
\DoxyCodeLine{00091 \}}
\DoxyCodeLine{00092 }
\DoxyCodeLine{\Hypertarget{potentials_8libmd_8cc_source_l00093}\mbox{\hyperlink{libmd_8h_a60601f0c510687b04a3ae288ba5f4565_a60601f0c510687b04a3ae288ba5f4565}{00093}} \textcolor{keyword}{template}<\textcolor{keyword}{class} X> X \mbox{\hyperlink{potentials_8libmd_8cc_a60601f0c510687b04a3ae288ba5f4565_a60601f0c510687b04a3ae288ba5f4565}{HOOKEANFORCEDIPOLE}}(X r,std::vector<ldf> \&parameters)}
\DoxyCodeLine{00094 \{}
\DoxyCodeLine{00095     std::vector<ldf> sprparams(parameters.begin(),parameters.begin()+2);}
\DoxyCodeLine{00096     std::vector<ldf> fdparams(parameters.begin()+2,parameters.begin()+3);}
\DoxyCodeLine{00097 }
\DoxyCodeLine{00098     \textcolor{keywordflow}{if} (parameters.size() == 3) \textcolor{keywordflow}{return} \mbox{\hyperlink{potentials_8libmd_8cc_a82eec3e4535cd60b73051cf9970be606_a82eec3e4535cd60b73051cf9970be606}{HOOKEAN}}(r, sprparams) + \mbox{\hyperlink{potentials_8libmd_8cc_a082699d879383d5964f469bd32984224_a082699d879383d5964f469bd32984224}{FORCEDIPOLE}}(r, fdparams);}
\DoxyCodeLine{00099 }
\DoxyCodeLine{00100     \textcolor{comment}{// if threshold exists: force dipole kicks in when force due to spring extension/compression is larger than threshold.}}
\DoxyCodeLine{00101     \textcolor{comment}{// positive f => threshold is in extension; negative f => threshold is in compression.}}
\DoxyCodeLine{00102     \textcolor{comment}{// threshold must be positive for this interpretation to hold.}}
\DoxyCodeLine{00103     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} threshold = parameters[3];}
\DoxyCodeLine{00104     \textcolor{keywordflow}{return} \mbox{\hyperlink{potentials_8libmd_8cc_a82eec3e4535cd60b73051cf9970be606_a82eec3e4535cd60b73051cf9970be606}{HOOKEAN}}(r, sprparams) + (sprparams[0]*(r-\/sprparams[1])*fdparams[0]/\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(fdparams[0]) > threshold)*\mbox{\hyperlink{potentials_8libmd_8cc_a082699d879383d5964f469bd32984224_a082699d879383d5964f469bd32984224}{FORCEDIPOLE}}(r, fdparams);}
\DoxyCodeLine{00105 \}}
\DoxyCodeLine{00106 }
\DoxyCodeLine{\Hypertarget{potentials_8libmd_8cc_source_l00107}\mbox{\hyperlink{libmd_8h_a3bc06782c0bafd9eb6e5e63a37a3fbad_a3bc06782c0bafd9eb6e5e63a37a3fbad}{00107}} \textcolor{keyword}{template}<\textcolor{keyword}{class} X> X \mbox{\hyperlink{potentials_8libmd_8cc_a3bc06782c0bafd9eb6e5e63a37a3fbad_a3bc06782c0bafd9eb6e5e63a37a3fbad}{ANHARMONICSPRING}}(X r,std::vector<ldf> \&parameters)}
\DoxyCodeLine{00108 \{}
\DoxyCodeLine{00119     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} k=parameters[0];}
\DoxyCodeLine{00120     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} r0=parameters[1];}
\DoxyCodeLine{00121     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} alpha=parameters[2];}
\DoxyCodeLine{00122     \textcolor{keywordflow}{return} (k/alpha)*\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{pow}}(\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{abs}}(r-\/r0),alpha);}
\DoxyCodeLine{00123 \}}

\end{DoxyCode}
