\hypertarget{energy_8md_8libmd_8cc_source}{}\doxysection{energy.\+md.\+libmd.\+cc}
\label{energy_8md_8libmd_8cc_source}\index{libmd-\/src/md/energy.md.libmd.cc@{libmd-\/src/md/energy.md.libmd.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{energy_8md_8libmd_8cc_source_l00001}\mbox{\hyperlink{energy_8md_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}{00001}} \textcolor{preprocessor}{\#define \_\_libmd\_src\_file\_\_}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#ifndef libmd\_h}}
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include "../../libmd.h"}}
\DoxyCodeLine{00004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00005 }
\DoxyCodeLine{\Hypertarget{energy_8md_8libmd_8cc_source_l00006}\mbox{\hyperlink{structmd_a81088a13b0d3de93ca661c00cb2a697f_a81088a13b0d3de93ca661c00cb2a697f}{00006}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmd_a81088a13b0d3de93ca661c00cb2a697f_a81088a13b0d3de93ca661c00cb2a697f}{md<dim>::thread\_H}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00011     \textcolor{keywordflow}{return} T(i)+V(i);}
\DoxyCodeLine{00012 \}}
\DoxyCodeLine{00013 }
\DoxyCodeLine{\Hypertarget{energy_8md_8libmd_8cc_source_l00014}\mbox{\hyperlink{structmd_a4ca9f88cee18bca90350dcb4cb74dda6_a4ca9f88cee18bca90350dcb4cb74dda6}{00014}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmd_a4ca9f88cee18bca90350dcb4cb74dda6_a4ca9f88cee18bca90350dcb4cb74dda6}{md<dim>::thread\_T}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i)}
\DoxyCodeLine{00015 \{}
\DoxyCodeLine{00019     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} retval=0.0;}
\DoxyCodeLine{00020     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) retval+=\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(particles[i].dx[d],2);}
\DoxyCodeLine{00021     \textcolor{keywordflow}{return} 0.5*particles[i].m*retval;}
\DoxyCodeLine{00022 \}}
\DoxyCodeLine{00023 }
\DoxyCodeLine{\Hypertarget{energy_8md_8libmd_8cc_source_l00024}\mbox{\hyperlink{structmd_a4220b18f9181ca58e4c943ddc204036a_a4220b18f9181ca58e4c943ddc204036a}{00024}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmd_a4220b18f9181ca58e4c943ddc204036a_a4220b18f9181ca58e4c943ddc204036a}{md<dim>::thread\_V}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i,\textcolor{keywordtype}{bool} higher\_index\_only)}
\DoxyCodeLine{00025 \{}
\DoxyCodeLine{00030     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} retval=0.0;}
\DoxyCodeLine{00031     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} rcosq=\mbox{\hyperlink{autodiff_8libmd_8cc_a4fd9e414f0c7ab2098dcea6c6de318d9_a4fd9e414f0c7ab2098dcea6c6de318d9}{std::pow}}(network.rco,2);}
\DoxyCodeLine{00032     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} sij: network.skins[i]) \textcolor{keywordflow}{if}(!higher\_index\_only or i<sij.neighbor)}
\DoxyCodeLine{00033     \{}
\DoxyCodeLine{00034         \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} rsq=distsq(i,sij.neighbor);}
\DoxyCodeLine{00035         \textcolor{keywordflow}{if}(rsq<rcosq)}
\DoxyCodeLine{00036         \{}
\DoxyCodeLine{00037             \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} r=\mbox{\hyperlink{autodiff_8libmd_8cc_af33bda4d5a7fc8ad1679ec339a730045_af33bda4d5a7fc8ad1679ec339a730045}{std::sqrt}}(rsq);}
\DoxyCodeLine{00038             retval+=v(network.library[sij.interaction].potential,r,network.library[sij.interaction].parameters);}
\DoxyCodeLine{00039             \textcolor{keywordflow}{if}(network.update) retval-\/=network.library[sij.interaction].vco;}
\DoxyCodeLine{00040         \}}
\DoxyCodeLine{00041     \}}
\DoxyCodeLine{00042     \textcolor{keywordflow}{return} retval;}
\DoxyCodeLine{00043 \}}
\DoxyCodeLine{00044 }
\DoxyCodeLine{\Hypertarget{energy_8md_8libmd_8cc_source_l00045}\mbox{\hyperlink{structmd_ac819b2c5b72eff6a5a744a530ce989b8_ac819b2c5b72eff6a5a744a530ce989b8}{00045}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmd_ac819b2c5b72eff6a5a744a530ce989b8_ac819b2c5b72eff6a5a744a530ce989b8}{md<dim>::H}}()}
\DoxyCodeLine{00046 \{}
\DoxyCodeLine{00050     \textcolor{keywordflow}{return} T()+V();}
\DoxyCodeLine{00051 \}}
\DoxyCodeLine{00052 }
\DoxyCodeLine{\Hypertarget{energy_8md_8libmd_8cc_source_l00053}\mbox{\hyperlink{structmd_a488e1a9324101cdd114f29fdfa8d9138_a488e1a9324101cdd114f29fdfa8d9138}{00053}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmd_a488e1a9324101cdd114f29fdfa8d9138_a488e1a9324101cdd114f29fdfa8d9138}{md<dim>::T}}()}
\DoxyCodeLine{00054 \{}
\DoxyCodeLine{00058     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} retval=0.0;}
\DoxyCodeLine{00059     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) retval+=thread\_T(i);}
\DoxyCodeLine{00060     \textcolor{keywordflow}{return} retval;}
\DoxyCodeLine{00061 \}}
\DoxyCodeLine{00062 }
\DoxyCodeLine{\Hypertarget{energy_8md_8libmd_8cc_source_l00063}\mbox{\hyperlink{structmd_a6e9b7da2ae3efacc7b0cfba63f41e7bd_a6e9b7da2ae3efacc7b0cfba63f41e7bd}{00063}} \textcolor{keyword}{template}<ui dim> \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{structmd_a6e9b7da2ae3efacc7b0cfba63f41e7bd_a6e9b7da2ae3efacc7b0cfba63f41e7bd}{md<dim>::V}}()}
\DoxyCodeLine{00064 \{}
\DoxyCodeLine{00068     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} retval=0.0;}
\DoxyCodeLine{00069     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i=0;i<N;i++) retval+=thread\_V(i,\textcolor{keyword}{true});}
\DoxyCodeLine{00070     \textcolor{keywordflow}{return} retval;}
\DoxyCodeLine{00071 \}}

\end{DoxyCode}
