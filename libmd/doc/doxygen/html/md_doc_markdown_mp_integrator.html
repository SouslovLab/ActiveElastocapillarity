<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libmd: Monge patch integrators</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="libmd-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libmd
   &#160;<span id="projectnumber">-0.</span>
   </div>
   <div id="projectbrief">A molecular dynamics library optimized for soft matter</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_doc_markdown_mp_integrator.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Monge patch integrators </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="mp-integrator"></a>
Integrators in libmd</h1>
<p>In libmd there are integrators for <a href="#md-integrator">flat space</a> and integrators for curved space (discussed here). All integrators in libmd are symplectic, see <a href="#md-int-ref">1</a> and <a href="#md-int-ref">2</a>. Symplectic integrators are integrators that preserve the Lagrangian symmetries. Therefore integration methods like explicit Euler or Runge-Kutta are not used.</p>
<h2><a class="anchor" id="mp-integrator-patch"></a>
Monge patch space integrators</h2>
<p>For curved space molecular dynamics multiple integrators a provide some of which are invalid:</p><ul>
<li><a class="el" href="md_doc_markdown_integrator.html#md-symeul">Symplectic Euler</a> inherited from flat space</li>
<li><a class="el" href="md_doc_markdown_integrator.html#md-vverlet">Velocity Verlet</a> inherited from flat space</li>
<li><a href="#mp-vanzuiden">van Zuiden</a> possibly somewhat narcisstically named.</li>
<li><a href="#mp-vanzuiden">van Zuiden WFI</a> the van Zuiden integrator without fixed point iterations</li>
<li><a href="#mp-vanzuiden">van Zuiden P</a> the van Zuiden integrator with limited fixed point iterations</li>
</ul>
<h3><a class="anchor" id="mp-vanzuiden"></a>
The van Zuiden integrator</h3>
<p>The van Zuiden integrator is derived using Variational integrators &ndash; see <a class="el" href="md_doc_markdown_integrator.html#md-int-ref">1</a> and <a class="el" href="md_doc_markdown_integrator.html#md-int-ref">2</a> &ndash; using the following Lagrangian: </p><p class="formulaDsp">
\begin{align} L=\tfrac{1}{2} m g_{\mu \nu} \dot{x}^{\mu} \dot{x}^{\nu} - V(x^{\rho}) \end{align}
</p>
<p> where \(g_{\mu \nu}\) is the metric tensor. By discritizing in time and applying the discritized Euler&ndash;Lagrange equatioins we obtain: </p><p class="formulaDsp">
\begin{align} \epsilon^{\rho}=g^{\sigma \rho} \left( \Gamma_{\nu \sigma \mu} \epsilon^{\mu} \epsilon^{\nu} + C_{\sigma} \right) \end{align}
</p>
<p> where \(g^{\mu \nu}\) is the metric inverse, \(\epsilon^{\mu}=x^{\mu}_{t+1}-x^{\mu}_{t}\), \(\Gamma_{\sigma \mu \nu}\) are the Christoffel symbols of the first kind. The latter equations can be solved using fixed points iterations using the starting point: </p><p class="formulaDsp">
\begin{align} \epsilon^{\rho}=g^{\sigma \rho} C_{\sigma} \end{align}
</p>
<p>The metric can be modified as discussed <a class="el" href="md_doc_markdown_mongepatch.html#mp-curvature">here</a>.</p>
<h2><a class="anchor" id="mp-integrators"></a>
Integrators structure</h2>
<p>Integrators in libmd can be controlled with the integrate structure in <code><a class="el" href="structmd_a649701c926568a12bc6fef1e182bdf23.html#a649701c926568a12bc6fef1e182bdf23" title="Integration method.">md&lt;dim&gt;::integrator</a></code> of type <code><a class="el" href="structintegrators.html" title="This structure defines and saves integration metadata.">integrators</a></code>. For curved space two objects are relevant:</p><ul>
<li><code><a class="el" href="structintegrators_ab59dc99049468eafc9f5b4c5e461077e.html#ab59dc99049468eafc9f5b4c5e461077e" title="Timestep size.">integrators::h</a></code> the time step</li>
<li><code><a class="el" href="structintegrators_ac4b901fdae2c7adf5599cc9a1d1883ae.html#ac4b901fdae2c7adf5599cc9a1d1883ae" title="Type of integration.">integrators::method</a></code> the integration method</li>
<li><code><a class="el" href="structintegrators_adb070aad7ba3928ed9376568b00bfb49.html#adb070aad7ba3928ed9376568b00bfb49" title="Maximum generations of timestep.">integrators::generations</a></code> number of allowed fixed point iterations</li>
</ul>
<p>The time step controls the time evolution. As a rule of thumb the time steps shouldn't be to big because the velocities will arbitrarily rise as the potentials give too large energies, as particles end up where they shouldn't be (due to errors). A time step should not be to large as floating point errors will accumulate creating an error and/or barely any evolution takes place. Keep in mind that the physics should not be dependent on the choice of time step, it it does, than the time step is probably too small or too large. If the time step is not to small and not to large the symplecticity of the integrator will ensure the Lagrangian symmetries are preserved. The default time step size is \(h=10^{-3}\). The default value of generations is 10.</p>
<p>The curved space integration methods supported by libmd are enumerated in <a class="el" href="struct_m_p___i_n_t_e_g_r_a_t_o_r_a6d6719917c0d2a6ffd3f204711ee6397.html#a6d6719917c0d2a6ffd3f204711ee6397">MP_INTEGRATOR::mp_integrator</a>. The default method is van Zuiden. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 3 2020 18:38:06 for libmd by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
