\hypertarget{box_8libmd_8cc}{}\doxysection{libmd-\/src/box.libmd.\+cc File Reference}
\label{box_8libmd_8cc}\index{libmd-\/src/box.libmd.cc@{libmd-\/src/box.libmd.cc}}
{\ttfamily \#include \char`\"{}../libmd.\+h\char`\"{}}\newline
Include dependency graph for box.\+libmd.\+cc\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{box_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}{\+\_\+\+\_\+libmd\+\_\+src\+\_\+file\+\_\+\+\_\+}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$ui dim$>$ }\\\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{box_8libmd_8cc_a40b2bff2b597ae82496372ce80675e68_a40b2bff2b597ae82496372ce80675e68}{det}} (\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} Ain\mbox{[}dim\mbox{]}\mbox{[}dim\mbox{]}, \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} B\mbox{[}dim\mbox{]}\mbox{[}dim\mbox{]})
\item 
\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{box_8libmd_8cc_a6cd0aa49a5b7e5f19e536645a57ae45d_a6cd0aa49a5b7e5f19e536645a57ae45d}{det}} (\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} Ain\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} B\mbox{[}2\mbox{]}\mbox{[}2\mbox{]})
\item 
\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{box_8libmd_8cc_a9810dfd3857d9af2517cebc5b8f05cf8_a9810dfd3857d9af2517cebc5b8f05cf8}{det}} (\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} Ain\mbox{[}3\mbox{]}\mbox{[}3\mbox{]}, \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} B\mbox{[}3\mbox{]}\mbox{[}3\mbox{]})
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} \mbox{\hyperlink{box_8libmd_8cc_ace215f31f28f0e6769853d07f36afc3f_ace215f31f28f0e6769853d07f36afc3f}{mxinv\+\_\+eps}} =\mbox{\hyperlink{autodiff2_8libmd_8cc_a23c702b1c84c5e7802e4cbbec9adf8f3_a23c702b1c84c5e7802e4cbbec9adf8f3}{sqrt}}(std\+::numeric\+\_\+limits$<$\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}$>$\+::epsilon())
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{box_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}\label{box_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}} 
\index{box.libmd.cc@{box.libmd.cc}!\_\_libmd\_src\_file\_\_@{\_\_libmd\_src\_file\_\_}}
\index{\_\_libmd\_src\_file\_\_@{\_\_libmd\_src\_file\_\_}!box.libmd.cc@{box.libmd.cc}}
\doxysubsubsection{\texorpdfstring{\_\_libmd\_src\_file\_\_}{\_\_libmd\_src\_file\_\_}}
{\footnotesize\ttfamily \#define \+\_\+\+\_\+libmd\+\_\+src\+\_\+file\+\_\+\+\_\+}



Definition at line \mbox{\hyperlink{box_8libmd_8cc_source_l00001}{1}} of file \mbox{\hyperlink{box_8libmd_8cc_source}{box.\+libmd.\+cc}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{box_8libmd_8cc_a6cd0aa49a5b7e5f19e536645a57ae45d_a6cd0aa49a5b7e5f19e536645a57ae45d}\label{box_8libmd_8cc_a6cd0aa49a5b7e5f19e536645a57ae45d_a6cd0aa49a5b7e5f19e536645a57ae45d}} 
\index{box.libmd.cc@{box.libmd.cc}!det@{det}}
\index{det@{det}!box.libmd.cc@{box.libmd.cc}}
\doxysubsubsection{\texorpdfstring{det()}{det()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} det (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{Ain\mbox{[}2\mbox{]}\mbox{[}2\mbox{]},  }\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{B\mbox{[}2\mbox{]}\mbox{[}2\mbox{]} }\end{DoxyParamCaption})}

Return the determinant of the array {\ttfamily Ain}, and store its inverse in the array {\ttfamily B} if the determinant is nonzero. Specialized function for dim=2

Definition at line \mbox{\hyperlink{box_8libmd_8cc_source_l00116}{116}} of file \mbox{\hyperlink{box_8libmd_8cc_source}{box.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00117 \{}
\DoxyCodeLine{00123     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} d = Ain[0][0]*Ain[1][1] -\/ Ain[0][1]*Ain[1][0];}
\DoxyCodeLine{00124     \textcolor{keywordflow}{if} (\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(d) < \mbox{\hyperlink{box_8libmd_8cc_ace215f31f28f0e6769853d07f36afc3f_ace215f31f28f0e6769853d07f36afc3f}{mxinv\_eps}})}
\DoxyCodeLine{00125         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00126     B[0][0] = Ain[1][1] / d;}
\DoxyCodeLine{00127     B[0][1] = -\/Ain[0][1] / d;}
\DoxyCodeLine{00128     B[1][0] = -\/Ain[1][0] / d;}
\DoxyCodeLine{00129     B[1][1] = Ain[0][0] / d;}
\DoxyCodeLine{00130     \textcolor{keywordflow}{return} d;}
\DoxyCodeLine{00131 \}}

\end{DoxyCode}


References \mbox{\hyperlink{autodiff_8libmd_8cc_source_l00364}{abs()}}, and \mbox{\hyperlink{box_8libmd_8cc_source_l00006}{mxinv\+\_\+eps}}.

Here is the call graph for this function\+:
% FIG 2
\mbox{\Hypertarget{box_8libmd_8cc_a9810dfd3857d9af2517cebc5b8f05cf8_a9810dfd3857d9af2517cebc5b8f05cf8}\label{box_8libmd_8cc_a9810dfd3857d9af2517cebc5b8f05cf8_a9810dfd3857d9af2517cebc5b8f05cf8}} 
\index{box.libmd.cc@{box.libmd.cc}!det@{det}}
\index{det@{det}!box.libmd.cc@{box.libmd.cc}}
\doxysubsubsection{\texorpdfstring{det()}{det()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} det (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{Ain\mbox{[}3\mbox{]}\mbox{[}3\mbox{]},  }\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{B\mbox{[}3\mbox{]}\mbox{[}3\mbox{]} }\end{DoxyParamCaption})}

Return the determinant of the array {\ttfamily Ain}, and store its inverse in the array {\ttfamily B} if the determinant is nonzero. Specialized function for dim=3

Definition at line \mbox{\hyperlink{box_8libmd_8cc_source_l00133}{133}} of file \mbox{\hyperlink{box_8libmd_8cc_source}{box.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00134 \{}
\DoxyCodeLine{00140     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} d =   Ain[0][0] * (Ain[1][1]*Ain[2][2] -\/ Ain[1][2]*Ain[2][1])}
\DoxyCodeLine{00141             + Ain[0][1] * (Ain[1][2]*Ain[2][0] -\/ Ain[1][0]*Ain[2][2])}
\DoxyCodeLine{00142             + Ain[0][2] * (Ain[1][0]*Ain[2][1] -\/ Ain[1][1]*Ain[2][0]);}
\DoxyCodeLine{00143     \textcolor{keywordflow}{if} (\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(d) < \mbox{\hyperlink{box_8libmd_8cc_ace215f31f28f0e6769853d07f36afc3f_ace215f31f28f0e6769853d07f36afc3f}{mxinv\_eps}})}
\DoxyCodeLine{00144         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00145     B[0][0] = (Ain[1][1]*Ain[2][2] -\/ Ain[1][2]*Ain[2][1]) / d;}
\DoxyCodeLine{00146     B[1][0] = (Ain[1][2]*Ain[2][0] -\/ Ain[1][0]*Ain[2][2]) / d;}
\DoxyCodeLine{00147     B[2][0] = (Ain[1][0]*Ain[2][1] -\/ Ain[1][1]*Ain[2][0]) / d;}
\DoxyCodeLine{00148     B[0][1] = (Ain[2][1]*Ain[0][2] -\/ Ain[2][2]*Ain[0][1]) / d;}
\DoxyCodeLine{00149     B[1][1] = (Ain[2][2]*Ain[0][0] -\/ Ain[2][0]*Ain[0][2]) / d;}
\DoxyCodeLine{00150     B[2][1] = (Ain[2][0]*Ain[0][1] -\/ Ain[2][1]*Ain[0][0]) / d;}
\DoxyCodeLine{00151     B[0][2] = (Ain[0][1]*Ain[1][2] -\/ Ain[0][2]*Ain[1][1]) / d;}
\DoxyCodeLine{00152     B[1][2] = (Ain[0][2]*Ain[1][0] -\/ Ain[0][0]*Ain[1][2]) / d;}
\DoxyCodeLine{00153     B[2][2] = (Ain[0][0]*Ain[1][1] -\/ Ain[0][1]*Ain[1][0]) / d;}
\DoxyCodeLine{00154     \textcolor{keywordflow}{return} d;}
\DoxyCodeLine{00155 \}}

\end{DoxyCode}


References \mbox{\hyperlink{autodiff_8libmd_8cc_source_l00364}{abs()}}, and \mbox{\hyperlink{box_8libmd_8cc_source_l00006}{mxinv\+\_\+eps}}.

Here is the call graph for this function\+:
% FIG 3
\mbox{\Hypertarget{box_8libmd_8cc_a40b2bff2b597ae82496372ce80675e68_a40b2bff2b597ae82496372ce80675e68}\label{box_8libmd_8cc_a40b2bff2b597ae82496372ce80675e68_a40b2bff2b597ae82496372ce80675e68}} 
\index{box.libmd.cc@{box.libmd.cc}!det@{det}}
\index{det@{det}!box.libmd.cc@{box.libmd.cc}}
\doxysubsubsection{\texorpdfstring{det()}{det()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$ui dim$>$ \\
\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} det (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{Ain\mbox{[}dim\mbox{]}\mbox{[}dim\mbox{]},  }\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{B\mbox{[}dim\mbox{]}\mbox{[}dim\mbox{]} }\end{DoxyParamCaption})}

Return the determinant of the array {\ttfamily Ain}, and store its inverse in the array {\ttfamily B} if the determinant is nonzero.

Definition at line \mbox{\hyperlink{box_8libmd_8cc_source_l00064}{64}} of file \mbox{\hyperlink{box_8libmd_8cc_source}{box.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00065 \{}
\DoxyCodeLine{00070     \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i, j, k;}
\DoxyCodeLine{00071     \textcolor{keywordtype}{int} sgn = 1;}
\DoxyCodeLine{00072     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} d = 1, t1, t2;}
\DoxyCodeLine{00073 }
\DoxyCodeLine{00074     \textcolor{comment}{// clone Ain so that it is unchanged}}
\DoxyCodeLine{00075     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} A[dim][dim];}
\DoxyCodeLine{00076     std::copy(\&Ain[0][0], \&Ain[0][0]+dim*dim,\&A[0][0]);}
\DoxyCodeLine{00077 }
\DoxyCodeLine{00078     \textcolor{comment}{// Initialize B to identity matrix}}
\DoxyCodeLine{00079     memset(B,0,dim*dim*\textcolor{keyword}{sizeof}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}));}
\DoxyCodeLine{00080     \textcolor{keywordflow}{for}(i=0;i<dim;i++) B[i][i]=1.0;}
\DoxyCodeLine{00081     \textcolor{keywordflow}{for} (i = 0; i < dim; i++)}
\DoxyCodeLine{00082     \{ \textcolor{comment}{// Look for largest pivot}}
\DoxyCodeLine{00083         j = i;}
\DoxyCodeLine{00084         \textcolor{keywordflow}{for} (k = i+1; k < dim; k++)}
\DoxyCodeLine{00085             \textcolor{keywordflow}{if} (\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(A[j][i]) < \mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(A[k][i]))}
\DoxyCodeLine{00086                 j = k;}
\DoxyCodeLine{00087         \textcolor{comment}{// No nonzero pivot implies singular matrix}}
\DoxyCodeLine{00088         \textcolor{keywordflow}{if} (\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(A[j][i]) < \mbox{\hyperlink{box_8libmd_8cc_ace215f31f28f0e6769853d07f36afc3f_ace215f31f28f0e6769853d07f36afc3f}{mxinv\_eps}})}
\DoxyCodeLine{00089             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00090         \textcolor{comment}{// Swap rows if necessary}}
\DoxyCodeLine{00091         \textcolor{keywordflow}{if} (j > i)}
\DoxyCodeLine{00092         \{}
\DoxyCodeLine{00093             sgn *= -\/1; \textcolor{comment}{// Switch sign of determinant}}
\DoxyCodeLine{00094             std::swap\_ranges(A[i]+i, A[i]+dim, A[j]+i);}
\DoxyCodeLine{00095             std::swap\_ranges(B[i], B[i]+dim, B[j]);}
\DoxyCodeLine{00096         \}}
\DoxyCodeLine{00097         \textcolor{comment}{// Reduce other rows}}
\DoxyCodeLine{00098         t1 = A[i][i]/d;}
\DoxyCodeLine{00099         \textcolor{keywordflow}{for} (j = 0; j < dim; j++)}
\DoxyCodeLine{00100             \textcolor{keywordflow}{if} (j != i)}
\DoxyCodeLine{00101             \{}
\DoxyCodeLine{00102                 t2 = A[j][i]/d;}
\DoxyCodeLine{00103                 \textcolor{keywordflow}{for} (k = i; k < dim; k++)}
\DoxyCodeLine{00104                     A[j][k] = t1 * A[j][k] -\/ t2 * A[i][k];}
\DoxyCodeLine{00105                 \textcolor{keywordflow}{for} (k = 0; k < dim; k++)}
\DoxyCodeLine{00106                     B[j][k] = t1 * B[j][k] -\/ t2 * B[i][k];}
\DoxyCodeLine{00107             \}}
\DoxyCodeLine{00108         d *= t1;}
\DoxyCodeLine{00109     \}}
\DoxyCodeLine{00110     \textcolor{keywordflow}{for} (i = 0; i < dim; i++)}
\DoxyCodeLine{00111         \textcolor{keywordflow}{for} (j = 0; j < dim; j++)}
\DoxyCodeLine{00112             B[i][j] /= d;}
\DoxyCodeLine{00113     \textcolor{keywordflow}{return} sgn * d;}
\DoxyCodeLine{00114 \}}

\end{DoxyCode}


References \mbox{\hyperlink{autodiff_8libmd_8cc_source_l00364}{abs()}}, and \mbox{\hyperlink{box_8libmd_8cc_source_l00006}{mxinv\+\_\+eps}}.

Here is the call graph for this function\+:
% FIG 4
Here is the caller graph for this function\+:
% FIG 5


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{box_8libmd_8cc_ace215f31f28f0e6769853d07f36afc3f_ace215f31f28f0e6769853d07f36afc3f}\label{box_8libmd_8cc_ace215f31f28f0e6769853d07f36afc3f_ace215f31f28f0e6769853d07f36afc3f}} 
\index{box.libmd.cc@{box.libmd.cc}!mxinv\_eps@{mxinv\_eps}}
\index{mxinv\_eps@{mxinv\_eps}!box.libmd.cc@{box.libmd.cc}}
\doxysubsubsection{\texorpdfstring{mxinv\_eps}{mxinv\_eps}}
{\footnotesize\ttfamily const \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} mxinv\+\_\+eps =\mbox{\hyperlink{autodiff2_8libmd_8cc_a23c702b1c84c5e7802e4cbbec9adf8f3_a23c702b1c84c5e7802e4cbbec9adf8f3}{sqrt}}(std\+::numeric\+\_\+limits$<$\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}$>$\+::epsilon())}



Definition at line \mbox{\hyperlink{box_8libmd_8cc_source_l00006}{6}} of file \mbox{\hyperlink{box_8libmd_8cc_source}{box.\+libmd.\+cc}}.

