\hypertarget{boundaryconditions_8libmd_8cc}{}\doxysection{libmd-\/src/boundaryconditions.libmd.\+cc File Reference}
\label{boundaryconditions_8libmd_8cc}\index{libmd-\/src/boundaryconditions.libmd.cc@{libmd-\/src/boundaryconditions.libmd.cc}}
{\ttfamily \#include \char`\"{}../libmd.\+h\char`\"{}}\newline
Include dependency graph for boundaryconditions.\+libmd.\+cc\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{boundaryconditions_8libmd_8cc__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{boundaryconditions_8libmd_8cc__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{boundaryconditions_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}{\+\_\+\+\_\+libmd\+\_\+src\+\_\+file\+\_\+\+\_\+}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$ui dim$>$ }\\void \mbox{\hyperlink{boundaryconditions_8libmd_8cc_a125b8967bd2a122e454f6baa1268ee59_a125b8967bd2a122e454f6baa1268ee59}{B\+C\+O\+N\+D\+\_\+\+N\+O\+NE}} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d, \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i, void $\ast$sys)
\item 
{\footnotesize template$<$ui dim$>$ }\\void \mbox{\hyperlink{boundaryconditions_8libmd_8cc_a97ae56c5ca0f92c083ef8fc369ade6a6_a97ae56c5ca0f92c083ef8fc369ade6a6}{B\+C\+O\+N\+D\+\_\+\+N\+O\+NE}} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d, \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x\mbox{[}dim\mbox{]}, void $\ast$sys)
\item 
{\footnotesize template$<$ui dim$>$ }\\void \mbox{\hyperlink{boundaryconditions_8libmd_8cc_a3ce0157b0762adc9e1789ba0362b9041_a3ce0157b0762adc9e1789ba0362b9041}{B\+C\+O\+N\+D\+\_\+\+P\+E\+R\+I\+O\+D\+IC}} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d, \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i, void $\ast$sys)
\item 
{\footnotesize template$<$ui dim$>$ }\\void \mbox{\hyperlink{boundaryconditions_8libmd_8cc_ad3106cf4919cc0df6111afd9315a32e6_ad3106cf4919cc0df6111afd9315a32e6}{B\+C\+O\+N\+D\+\_\+\+P\+E\+R\+I\+O\+D\+IC}} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d, \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x\mbox{[}dim\mbox{]}, void $\ast$sys)
\item 
{\footnotesize template$<$ui dim$>$ }\\void \mbox{\hyperlink{boundaryconditions_8libmd_8cc_a2893f1abcebbd51fb9f4748ce2e97b7a_a2893f1abcebbd51fb9f4748ce2e97b7a}{B\+C\+O\+N\+D\+\_\+\+H\+A\+RD}} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d, \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i, void $\ast$sys)
\item 
{\footnotesize template$<$ui dim$>$ }\\void \mbox{\hyperlink{boundaryconditions_8libmd_8cc_ad7ccf55e9e770d9f0e222c8c4374adde_ad7ccf55e9e770d9f0e222c8c4374adde}{B\+C\+O\+N\+D\+\_\+\+H\+A\+RD}} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d, \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x\mbox{[}dim\mbox{]}, void $\ast$sys)
\item 
{\footnotesize template$<$ui dim$>$ }\\void \mbox{\hyperlink{boundaryconditions_8libmd_8cc_af498e0276167e137bfc61a7d8b8f1da6_af498e0276167e137bfc61a7d8b8f1da6}{B\+C\+O\+N\+D\+\_\+\+B\+O\+X\+S\+H\+E\+AR}} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d, \mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i, void $\ast$sys)
\item 
{\footnotesize template$<$ui dim$>$ }\\void \mbox{\hyperlink{boundaryconditions_8libmd_8cc_a376c47134fbeb6fa1280dd1a7ee013e6_a376c47134fbeb6fa1280dd1a7ee013e6}{B\+C\+O\+N\+D\+\_\+\+B\+O\+X\+S\+H\+E\+AR}} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d, \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} x\mbox{[}dim\mbox{]}, void $\ast$sys)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{boundaryconditions_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}\label{boundaryconditions_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}} 
\index{boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}!\_\_libmd\_src\_file\_\_@{\_\_libmd\_src\_file\_\_}}
\index{\_\_libmd\_src\_file\_\_@{\_\_libmd\_src\_file\_\_}!boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}}
\doxysubsubsection{\texorpdfstring{\_\_libmd\_src\_file\_\_}{\_\_libmd\_src\_file\_\_}}
{\footnotesize\ttfamily \#define \+\_\+\+\_\+libmd\+\_\+src\+\_\+file\+\_\+\+\_\+}



Definition at line \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source_l00001}{1}} of file \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source}{boundaryconditions.\+libmd.\+cc}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{boundaryconditions_8libmd_8cc_a376c47134fbeb6fa1280dd1a7ee013e6_a376c47134fbeb6fa1280dd1a7ee013e6}\label{boundaryconditions_8libmd_8cc_a376c47134fbeb6fa1280dd1a7ee013e6_a376c47134fbeb6fa1280dd1a7ee013e6}} 
\index{boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}!BCOND\_BOXSHEAR@{BCOND\_BOXSHEAR}}
\index{BCOND\_BOXSHEAR@{BCOND\_BOXSHEAR}!boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}}
\doxysubsubsection{\texorpdfstring{BCOND\_BOXSHEAR()}{BCOND\_BOXSHEAR()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$ui dim$>$ \\
void B\+C\+O\+N\+D\+\_\+\+B\+O\+X\+S\+H\+E\+AR (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{d,  }\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{x\mbox{[}dim\mbox{]},  }\item[{void $\ast$}]{sys }\end{DoxyParamCaption})}

Periodicity function to be called if dimension {\ttfamily d} has sheared boundary conditions.

Checks if point {\ttfamily x} is outside the boundary perpendicular to dimension {\ttfamily d} and, if so, updates its position according to the box shear matrices stored in {\ttfamily simbox.\+Lshear} and {\ttfamily simbox.\+vshear}. The particle position

Definition at line \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source_l00184}{184}} of file \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source}{boundaryconditions.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00185 \{}
\DoxyCodeLine{00195     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} boundaryCrossing=std::round(x[d]/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]);}
\DoxyCodeLine{00196     \textcolor{keywordflow}{if}((\textcolor{keywordtype}{int})boundaryCrossing) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++) x[k]-\/=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.Lshear[k][d]*boundaryCrossing;}
\DoxyCodeLine{00197 \}}

\end{DoxyCode}


References \mbox{\hyperlink{macros_8libmd_8h_source_l00006}{S\+YS}}.

\mbox{\Hypertarget{boundaryconditions_8libmd_8cc_af498e0276167e137bfc61a7d8b8f1da6_af498e0276167e137bfc61a7d8b8f1da6}\label{boundaryconditions_8libmd_8cc_af498e0276167e137bfc61a7d8b8f1da6_af498e0276167e137bfc61a7d8b8f1da6}} 
\index{boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}!BCOND\_BOXSHEAR@{BCOND\_BOXSHEAR}}
\index{BCOND\_BOXSHEAR@{BCOND\_BOXSHEAR}!boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}}
\doxysubsubsection{\texorpdfstring{BCOND\_BOXSHEAR()}{BCOND\_BOXSHEAR()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$ui dim$>$ \\
void B\+C\+O\+N\+D\+\_\+\+B\+O\+X\+S\+H\+E\+AR (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{d,  }\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{i,  }\item[{void $\ast$}]{sys }\end{DoxyParamCaption})}

Periodicity function to be called if dimension {\ttfamily d} has sheared boundary conditions.

Checks if particle {\ttfamily i} has crossed the boundary perpendicular to dimension {\ttfamily d} and, if so, updates its position and velocity according to the box shear matrices stored in {\ttfamily simbox.\+Lshear} and {\ttfamily simbox.\+vshear}. The particle position

Definition at line \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source_l00164}{164}} of file \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source}{boundaryconditions.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00165 \{}
\DoxyCodeLine{00175     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} boundaryCrossing=std::round(\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[d]/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]);}
\DoxyCodeLine{00176     \textcolor{keywordflow}{if}((\textcolor{keywordtype}{int})boundaryCrossing) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++)}
\DoxyCodeLine{00177     \{}
\DoxyCodeLine{00178         \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[k]-\/=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.Lshear[k][d]*boundaryCrossing;}
\DoxyCodeLine{00179         \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].xp[k]-\/=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.Lshear[k][d]*boundaryCrossing;}
\DoxyCodeLine{00180         \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].dx[k]-\/=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.vshear[k][d]*boundaryCrossing;}
\DoxyCodeLine{00181     \}}
\DoxyCodeLine{00182 \}}

\end{DoxyCode}


References \mbox{\hyperlink{macros_8libmd_8h_source_l00006}{S\+YS}}.

\mbox{\Hypertarget{boundaryconditions_8libmd_8cc_ad7ccf55e9e770d9f0e222c8c4374adde_ad7ccf55e9e770d9f0e222c8c4374adde}\label{boundaryconditions_8libmd_8cc_ad7ccf55e9e770d9f0e222c8c4374adde_ad7ccf55e9e770d9f0e222c8c4374adde}} 
\index{boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}!BCOND\_HARD@{BCOND\_HARD}}
\index{BCOND\_HARD@{BCOND\_HARD}!boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}}
\doxysubsubsection{\texorpdfstring{BCOND\_HARD()}{BCOND\_HARD()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$ui dim$>$ \\
void B\+C\+O\+N\+D\+\_\+\+H\+A\+RD (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{d,  }\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{x\mbox{[}dim\mbox{]},  }\item[{void $\ast$}]{sys }\end{DoxyParamCaption})}

Periodicity function to be called if dimension {\ttfamily d} has hard boundary conditions.

Checks if point {\ttfamily x} is outside the boundary perpendicular to dimension {\ttfamily d} and, if so, updates its position to respect a hard wall reflection. The particle position is mirrored across the boundary wall. ~\newline
 This function correctly takes into account skewed boundary conditions, and uses the box matrices {\ttfamily simbox.\+Lshear} and {\ttfamily simbox.\+vshear} to calculate the reflections if {\ttfamily simbox.\+use\+Lshear} is {\ttfamily true}.

Definition at line \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source_l00119}{119}} of file \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source}{boundaryconditions.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00120 \{}
\DoxyCodeLine{00134     \textcolor{keywordflow}{if} (\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.useLshear)}
\DoxyCodeLine{00135     \{}
\DoxyCodeLine{00136         \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} s=0;}
\DoxyCodeLine{00137         \textcolor{keywordflow}{for} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++) s+=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.LshearInv[d][k]*x[k];}
\DoxyCodeLine{00138         if (\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(s) > 0.5) \textcolor{comment}{// particle has hit the hard boundary as distorted by the shear}}
\DoxyCodeLine{00139         \{}
\DoxyCodeLine{00140             \textcolor{keywordflow}{if} (\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(s) > 1.) \{ \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"dynamics led to particle displacement bigger than box size; hard boundary reflections undefined"}); \}}
\DoxyCodeLine{00141             \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} nhat[dim];}
\DoxyCodeLine{00142             \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} nlen=0.,xperp=0.,x0perp;}
\DoxyCodeLine{00143             \textcolor{comment}{// the normal vector to the box boundary in dimension d is the dth row of LshearInv}}
\DoxyCodeLine{00144             \textcolor{keywordflow}{for} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++) nlen += \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.LshearInv[d][k]*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.LshearInv[d][k];}
\DoxyCodeLine{00145             nlen = \mbox{\hyperlink{autodiff_8libmd_8cc_af33bda4d5a7fc8ad1679ec339a730045_af33bda4d5a7fc8ad1679ec339a730045}{sqrt}}(nlen);}
\DoxyCodeLine{00146             \textcolor{comment}{// projection of velocity and position perpendicular to boundary wall}}
\DoxyCodeLine{00147             \textcolor{keywordflow}{for} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++) \{}
\DoxyCodeLine{00148                 nhat[k] = \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.LshearInv[d][k]/nlen;}
\DoxyCodeLine{00149                 xperp += nhat[k]*x[k];}
\DoxyCodeLine{00150             \}}
\DoxyCodeLine{00151             x0perp = nhat[d]*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.Lshear[d][d]*0.5*(s > 0.? 1.:-\/1.);}
\DoxyCodeLine{00152 }
\DoxyCodeLine{00153             \textcolor{comment}{// subtract perpendicular component twice to get reflected velocity}}
\DoxyCodeLine{00154             \textcolor{keywordflow}{for} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++) x[k] -\/= 2.0*(xperp-\/x0perp)*nhat[k]; \textcolor{comment}{// reflection about a plane passing through point set by x0perp}}
\DoxyCodeLine{00155         \}}
\DoxyCodeLine{00156     \}}
\DoxyCodeLine{00157     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00158     \{}
\DoxyCodeLine{00159         \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} xnew=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]*(\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(x[d]/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]+0.5-\/2.0*floor(x[d]/(2.0*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d])+0.75))-\/0.5);}
\DoxyCodeLine{00160         x[d]=xnew;}
\DoxyCodeLine{00161     \}}
\DoxyCodeLine{00162 \}}

\end{DoxyCode}


References \mbox{\hyperlink{autodiff_8libmd_8cc_source_l00364}{abs()}}, \mbox{\hyperlink{autodiff_8libmd_8cc_source_l00268}{sqrt()}}, \mbox{\hyperlink{macros_8libmd_8h_source_l00006}{S\+YS}}, and \mbox{\hyperlink{macros_8libmd_8h_source_l00070}{W\+A\+R\+N\+I\+NG}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{boundaryconditions_8libmd_8cc_ad7ccf55e9e770d9f0e222c8c4374adde_ad7ccf55e9e770d9f0e222c8c4374adde_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{boundaryconditions_8libmd_8cc_a2893f1abcebbd51fb9f4748ce2e97b7a_a2893f1abcebbd51fb9f4748ce2e97b7a}\label{boundaryconditions_8libmd_8cc_a2893f1abcebbd51fb9f4748ce2e97b7a_a2893f1abcebbd51fb9f4748ce2e97b7a}} 
\index{boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}!BCOND\_HARD@{BCOND\_HARD}}
\index{BCOND\_HARD@{BCOND\_HARD}!boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}}
\doxysubsubsection{\texorpdfstring{BCOND\_HARD()}{BCOND\_HARD()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$ui dim$>$ \\
void B\+C\+O\+N\+D\+\_\+\+H\+A\+RD (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{d,  }\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{i,  }\item[{void $\ast$}]{sys }\end{DoxyParamCaption})}

Periodicity function to be called if dimension {\ttfamily d} has hard boundary conditions.

Checks if particle {\ttfamily i} has crossed the boundary perpendicular to dimension {\ttfamily d} and, if so, updates its position and velocity to respect a hard wall reflection. The particle position is mirrored across the boundary wall, whereas its velocity component perpendicular to the boundary wall is reversed. ~\newline
 This function correctly takes into account skewed boundary conditions, and uses the box matrices {\ttfamily simbox.\+Lshear} and {\ttfamily simbox.\+vshear} to calculate the reflections if {\ttfamily simbox.\+use\+Lshear} is {\ttfamily true}.

Definition at line \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source_l00061}{61}} of file \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source}{boundaryconditions.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00062 \{}
\DoxyCodeLine{00077     \textcolor{keywordflow}{if} (\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.useLshear)}
\DoxyCodeLine{00078     \{}
\DoxyCodeLine{00079         \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} s=0;}
\DoxyCodeLine{00080         \textcolor{keywordflow}{for} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++) s+=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.LshearInv[d][k]*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[k];}
\DoxyCodeLine{00081         if (\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(s) > 0.5) \textcolor{comment}{// particle has hit the hard boundary as distorted by the shear}}
\DoxyCodeLine{00082         \{}
\DoxyCodeLine{00083             \textcolor{keywordflow}{if} (\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(s) > 1.) \{ \mbox{\hyperlink{macros_8libmd_8h_a8d12d0f11fc9acd2f1fa22d80895ddae_a8d12d0f11fc9acd2f1fa22d80895ddae}{WARNING}}(\textcolor{stringliteral}{"dynamics led to particle displacement bigger than box size; hard boundary reflections undefined"}); \}}
\DoxyCodeLine{00084             \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} nhat[dim];}
\DoxyCodeLine{00085             \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} nlen=0.,vperp=0.,xperp=0.,x0perp;}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087             \textcolor{comment}{// the normal vector to the box boundary in dimension d is the dth row of LshearInv}}
\DoxyCodeLine{00088             \textcolor{keywordflow}{for} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++) nlen += \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.LshearInv[d][k]*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.LshearInv[d][k];}
\DoxyCodeLine{00089             nlen = \mbox{\hyperlink{autodiff_8libmd_8cc_af33bda4d5a7fc8ad1679ec339a730045_af33bda4d5a7fc8ad1679ec339a730045}{sqrt}}(nlen);}
\DoxyCodeLine{00090 }
\DoxyCodeLine{00091             \textcolor{comment}{// projection of velocity and position perpendicular to boundary wall}}
\DoxyCodeLine{00092             \textcolor{keywordflow}{for} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++) \{}
\DoxyCodeLine{00093                 nhat[k] = \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.LshearInv[d][k]/nlen;}
\DoxyCodeLine{00094                 vperp += nhat[k]*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].dx[k];}
\DoxyCodeLine{00095                 xperp += nhat[k]*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[k];}
\DoxyCodeLine{00096             \}}
\DoxyCodeLine{00097 }
\DoxyCodeLine{00098             x0perp = nhat[d]*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.Lshear[d][d]*0.5*(s > 0.? 1.:-\/1.);}
\DoxyCodeLine{00099 }
\DoxyCodeLine{00100             \textcolor{comment}{// subtract perpendicular component twice to get reflected velocity}}
\DoxyCodeLine{00101             \textcolor{keywordflow}{for} (\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} k=0;k<dim;k++)}
\DoxyCodeLine{00102             \{}
\DoxyCodeLine{00103                 \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].dx[k] -\/= 2.0*vperp*nhat[k];}
\DoxyCodeLine{00104                 \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[k] -\/= 2.0*(xperp-\/x0perp)*nhat[k]; \textcolor{comment}{// reflection about a plane passing through point set by x0perp}}
\DoxyCodeLine{00105                 \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].xp[k] += 2.0*(xperp-\/x0perp)*nhat[k];}
\DoxyCodeLine{00106             \}}
\DoxyCodeLine{00107         \}}
\DoxyCodeLine{00108     \}}
\DoxyCodeLine{00109     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00110     \{}
\DoxyCodeLine{00111         \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} xnew=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]*(\mbox{\hyperlink{autodiff_8libmd_8cc_aef1f4db2bbc91c997fdc24226ea63d52_aef1f4db2bbc91c997fdc24226ea63d52}{std::abs}}(\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[d]/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]+0.5-\/2.0*floor(\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[d]/(2.0*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d])+0.75))-\/0.5);}
\DoxyCodeLine{00112         \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} sign=(((int)std::round(\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[d]/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]))\%2?-\/1.0:1.0);}
\DoxyCodeLine{00113         \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].xp[d]+=sign*(xnew-\/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[d]);}
\DoxyCodeLine{00114         \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[d]=xnew;}
\DoxyCodeLine{00115         \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].dx[d]*=sign;}
\DoxyCodeLine{00116     \}}
\DoxyCodeLine{00117 \}}

\end{DoxyCode}


References \mbox{\hyperlink{autodiff_8libmd_8cc_source_l00364}{abs()}}, \mbox{\hyperlink{autodiff_8libmd_8cc_source_l00268}{sqrt()}}, \mbox{\hyperlink{macros_8libmd_8h_source_l00006}{S\+YS}}, and \mbox{\hyperlink{macros_8libmd_8h_source_l00070}{W\+A\+R\+N\+I\+NG}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{boundaryconditions_8libmd_8cc_a2893f1abcebbd51fb9f4748ce2e97b7a_a2893f1abcebbd51fb9f4748ce2e97b7a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{boundaryconditions_8libmd_8cc_a97ae56c5ca0f92c083ef8fc369ade6a6_a97ae56c5ca0f92c083ef8fc369ade6a6}\label{boundaryconditions_8libmd_8cc_a97ae56c5ca0f92c083ef8fc369ade6a6_a97ae56c5ca0f92c083ef8fc369ade6a6}} 
\index{boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}!BCOND\_NONE@{BCOND\_NONE}}
\index{BCOND\_NONE@{BCOND\_NONE}!boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}}
\doxysubsubsection{\texorpdfstring{BCOND\_NONE()}{BCOND\_NONE()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$ui dim$>$ \\
void B\+C\+O\+N\+D\+\_\+\+N\+O\+NE (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{d,  }\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{x\mbox{[}dim\mbox{]},  }\item[{void $\ast$}]{sys }\end{DoxyParamCaption})}

Periodicity function to be called if dimension {\ttfamily d} has no boundary conditions.

This function does nothing

Definition at line \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source_l00019}{19}} of file \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source}{boundaryconditions.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00020 \{}
\DoxyCodeLine{00027     (void) d;}
\DoxyCodeLine{00028     (void) x;}
\DoxyCodeLine{00029     (void) sys;}
\DoxyCodeLine{00030 \}}

\end{DoxyCode}
\mbox{\Hypertarget{boundaryconditions_8libmd_8cc_a125b8967bd2a122e454f6baa1268ee59_a125b8967bd2a122e454f6baa1268ee59}\label{boundaryconditions_8libmd_8cc_a125b8967bd2a122e454f6baa1268ee59_a125b8967bd2a122e454f6baa1268ee59}} 
\index{boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}!BCOND\_NONE@{BCOND\_NONE}}
\index{BCOND\_NONE@{BCOND\_NONE}!boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}}
\doxysubsubsection{\texorpdfstring{BCOND\_NONE()}{BCOND\_NONE()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$ui dim$>$ \\
void B\+C\+O\+N\+D\+\_\+\+N\+O\+NE (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{d,  }\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{i,  }\item[{void $\ast$}]{sys }\end{DoxyParamCaption})}

Periodicity function to be called if dimension {\ttfamily d} has no boundary conditions.

This function does nothing

Definition at line \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source_l00006}{6}} of file \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source}{boundaryconditions.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00014     (void) d;}
\DoxyCodeLine{00015     (void) i;}
\DoxyCodeLine{00016     (void) sys;}
\DoxyCodeLine{00017 \}}

\end{DoxyCode}
\mbox{\Hypertarget{boundaryconditions_8libmd_8cc_ad3106cf4919cc0df6111afd9315a32e6_ad3106cf4919cc0df6111afd9315a32e6}\label{boundaryconditions_8libmd_8cc_ad3106cf4919cc0df6111afd9315a32e6_ad3106cf4919cc0df6111afd9315a32e6}} 
\index{boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}!BCOND\_PERIODIC@{BCOND\_PERIODIC}}
\index{BCOND\_PERIODIC@{BCOND\_PERIODIC}!boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}}
\doxysubsubsection{\texorpdfstring{BCOND\_PERIODIC()}{BCOND\_PERIODIC()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$ui dim$>$ \\
void B\+C\+O\+N\+D\+\_\+\+P\+E\+R\+I\+O\+D\+IC (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{d,  }\item[{\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}}}]{x\mbox{[}dim\mbox{]},  }\item[{void $\ast$}]{sys }\end{DoxyParamCaption})}

Periodicity function to be called if dimension {\ttfamily d} has periodic boundary conditions.

Checks if point {\ttfamily x} is outside the boundary perpendicular to dimension {\ttfamily d} and, if so, shifts its coordinate in that dimension by multiples of {\ttfamily simbox.\+L\mbox{[}d\mbox{]}} so that it is within the bounds {\ttfamily (-\/simbox.\+L\mbox{[}d\mbox{]}/2,simbox.\+L\mbox{[}d\mbox{]}/2)}.

Definition at line \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source_l00047}{47}} of file \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source}{boundaryconditions.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00048 \{}
\DoxyCodeLine{00057     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} dx=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]*std::round(x[d]/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]);}
\DoxyCodeLine{00058     x[d]-\/=dx;}
\DoxyCodeLine{00059 \}}

\end{DoxyCode}


References \mbox{\hyperlink{macros_8libmd_8h_source_l00006}{S\+YS}}.

\mbox{\Hypertarget{boundaryconditions_8libmd_8cc_a3ce0157b0762adc9e1789ba0362b9041_a3ce0157b0762adc9e1789ba0362b9041}\label{boundaryconditions_8libmd_8cc_a3ce0157b0762adc9e1789ba0362b9041_a3ce0157b0762adc9e1789ba0362b9041}} 
\index{boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}!BCOND\_PERIODIC@{BCOND\_PERIODIC}}
\index{BCOND\_PERIODIC@{BCOND\_PERIODIC}!boundaryconditions.libmd.cc@{boundaryconditions.libmd.cc}}
\doxysubsubsection{\texorpdfstring{BCOND\_PERIODIC()}{BCOND\_PERIODIC()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$ui dim$>$ \\
void B\+C\+O\+N\+D\+\_\+\+P\+E\+R\+I\+O\+D\+IC (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{d,  }\item[{\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}}}]{i,  }\item[{void $\ast$}]{sys }\end{DoxyParamCaption})}

Periodicity function to be called if dimension {\ttfamily d} has periodic boundary conditions.

Checks if particle {\ttfamily i} has crossed the boundary perpendicular to dimension {\ttfamily d} and, if so, shifts its coordinate in that dimension by multiples of {\ttfamily simbox.\+L\mbox{[}d\mbox{]}} so that it is within the bounds {\ttfamily (-\/simbox.\+L\mbox{[}d\mbox{]}/2,simbox.\+L\mbox{[}d\mbox{]}/2)}.

Definition at line \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source_l00032}{32}} of file \mbox{\hyperlink{boundaryconditions_8libmd_8cc_source}{boundaryconditions.\+libmd.\+cc}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00033 \{}
\DoxyCodeLine{00042     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} dx=\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]*std::round(\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[d]/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>simbox.L[d]);}
\DoxyCodeLine{00043     \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].xp[d]-\/=dx;}
\DoxyCodeLine{00044     \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].x[d]-\/=dx;}
\DoxyCodeLine{00045 \}}

\end{DoxyCode}


References \mbox{\hyperlink{macros_8libmd_8h_source_l00006}{S\+YS}}.

