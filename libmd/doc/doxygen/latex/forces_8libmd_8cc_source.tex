\hypertarget{forces_8libmd_8cc_source}{}\doxysection{forces.\+libmd.\+cc}
\label{forces_8libmd_8cc_source}\index{libmd-\/src/forces.libmd.cc@{libmd-\/src/forces.libmd.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{forces_8libmd_8cc_source_l00001}\mbox{\hyperlink{forces_8libmd_8cc_a4384389855e24d346feb2e60f23afb0b_a4384389855e24d346feb2e60f23afb0b}{00001}} \textcolor{preprocessor}{\#define \_\_libmd\_src\_file\_\_}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#ifndef libmd\_h}}
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include "../libmd.h"}}
\DoxyCodeLine{00004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00005 }
\DoxyCodeLine{\Hypertarget{forces_8libmd_8cc_source_l00006}\mbox{\hyperlink{libmd_8h_aaf71a8b1e0517a6f9501e95c4408d1d1_aaf71a8b1e0517a6f9501e95c4408d1d1}{00006}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{forces_8libmd_8cc_ac79b5f9ede8edc6bd376d90312d8d900_ac79b5f9ede8edc6bd376d90312d8d900}{noise\_gen}}(\mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} noise[dim],\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} seed)}
\DoxyCodeLine{00007 \{}
\DoxyCodeLine{00014     \textcolor{keyword}{static} std::random\_device rd;}
\DoxyCodeLine{00015     \textcolor{keyword}{static} std::mt19937 mt(rd());}
\DoxyCodeLine{00016     \textcolor{keyword}{static} std::normal\_distribution<ldf> normal(0.0,1.0);}
\DoxyCodeLine{00017     \textcolor{keywordflow}{if}(seed) mt.seed(seed);}
\DoxyCodeLine{00018     \textcolor{keywordflow}{if}(noise) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) noise[d]=normal(mt);}
\DoxyCodeLine{00019 \}}
\DoxyCodeLine{00020 }
\DoxyCodeLine{\Hypertarget{forces_8libmd_8cc_source_l00021}\mbox{\hyperlink{libmd_8h_afdbadf91896c58754c50328fa20d2916_afdbadf91896c58754c50328fa20d2916}{00021}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{forces_8libmd_8cc_afdbadf91896c58754c50328fa20d2916_afdbadf91896c58754c50328fa20d2916}{DAMPING}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i,std::vector<ui> \&particles,std::vector<ldf> \&parameters,\textcolor{keywordtype}{void} *sys)}
\DoxyCodeLine{00022 \{}
\DoxyCodeLine{00031     (void) particles;}
\DoxyCodeLine{00032     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} gamma=parameters[0];}
\DoxyCodeLine{00033     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].F[d]-\/=gamma*\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].dx[d];}
\DoxyCodeLine{00034 \}}
\DoxyCodeLine{00035 }
\DoxyCodeLine{\Hypertarget{forces_8libmd_8cc_source_l00036}\mbox{\hyperlink{libmd_8h_ac068804729d4125f5c60e300c54e61c6_ac068804729d4125f5c60e300c54e61c6}{00036}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{forces_8libmd_8cc_ac068804729d4125f5c60e300c54e61c6_ac068804729d4125f5c60e300c54e61c6}{DISSIPATION}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i,std::vector<ui> \&particles,std::vector<ldf> \&parameters,\textcolor{keywordtype}{void} *sys)}
\DoxyCodeLine{00037 \{}
\DoxyCodeLine{00047     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} b=parameters[0];}
\DoxyCodeLine{00048     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it: particles) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].F[d]+=b*(\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>dv(d,i,it));}
\DoxyCodeLine{00049 \}}
\DoxyCodeLine{00050 }
\DoxyCodeLine{\Hypertarget{forces_8libmd_8cc_source_l00051}\mbox{\hyperlink{libmd_8h_ae8c991d6b345b8b1e7707f364ac01965_ae8c991d6b345b8b1e7707f364ac01965}{00051}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{forces_8libmd_8cc_ae8c991d6b345b8b1e7707f364ac01965_ae8c991d6b345b8b1e7707f364ac01965}{LANGEVIN}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i,std::vector<ui> \&particles,std::vector<ldf> \&parameters,\textcolor{keywordtype}{void} *sys)}
\DoxyCodeLine{00052 \{}
\DoxyCodeLine{00062     (void) particles;}
\DoxyCodeLine{00063     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} KbT=parameters[0];}
\DoxyCodeLine{00064     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} gamma=parameters[1];}
\DoxyCodeLine{00065     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} factor=\mbox{\hyperlink{autodiff_8libmd_8cc_af33bda4d5a7fc8ad1679ec339a730045_af33bda4d5a7fc8ad1679ec339a730045}{sqrt}}(2.0*gamma*KbT/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>integrator.h);}
\DoxyCodeLine{00066     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} noise[dim];}
\DoxyCodeLine{00067     noise\_gen<dim>(noise);}
\DoxyCodeLine{00068     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].F[d]+=factor*noise[d];}
\DoxyCodeLine{00069 \}}
\DoxyCodeLine{00070 }
\DoxyCodeLine{00071 }
\DoxyCodeLine{\Hypertarget{forces_8libmd_8cc_source_l00072}\mbox{\hyperlink{libmd_8h_a275ca4af41bc046ed3522574d3eb6690_a275ca4af41bc046ed3522574d3eb6690}{00072}} \textcolor{keyword}{template}<ui dim> \textcolor{keywordtype}{void} \mbox{\hyperlink{forces_8libmd_8cc_a275ca4af41bc046ed3522574d3eb6690_a275ca4af41bc046ed3522574d3eb6690}{LANGEVIN\_MP}}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} i,std::vector<ui> \&particles,std::vector<ldf> \&parameters,\textcolor{keywordtype}{void} *sys)}
\DoxyCodeLine{00073 \{}
\DoxyCodeLine{00083     (void) particles;}
\DoxyCodeLine{00084     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} KbT=parameters[0];}
\DoxyCodeLine{00085     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} gamma=parameters[1];}
\DoxyCodeLine{00086     \textcolor{keyword}{const} \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} factor=\mbox{\hyperlink{autodiff_8libmd_8cc_af33bda4d5a7fc8ad1679ec339a730045_af33bda4d5a7fc8ad1679ec339a730045}{sqrt}}(2.0*gamma*KbT/\mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>integrator.h);}
\DoxyCodeLine{00087     \mbox{\hyperlink{libmd_8h_a9b1cd8bf0a06d4a62c19f7953a3487ea_a9b1cd8bf0a06d4a62c19f7953a3487ea}{ldf}} noise[dim],metric\_noise[dim]=\{\};}
\DoxyCodeLine{00088     noise\_gen<dim>(noise);}
\DoxyCodeLine{00089     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} mu=0;mu<dim;mu++) \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} nu=0;nu<dim;nu++) metric\_noise[mu]+=\mbox{\hyperlink{macros_8libmd_8h_aa2f84af390fceaa32712e7c8f4e9906a_aa2f84af390fceaa32712e7c8f4e9906a}{MP\_SYS}}-\/>patch.sqrt\_ginv(i,mu,nu)*noise[nu];}
\DoxyCodeLine{00090     \textcolor{keywordflow}{for}(\mbox{\hyperlink{libmd_8h_aa0f39ee33b87675e11229913d432ffe7_aa0f39ee33b87675e11229913d432ffe7}{ui}} d=0;d<dim;d++) \mbox{\hyperlink{macros_8libmd_8h_ae3d9f52a1a315303ad04f0576bd42a25_ae3d9f52a1a315303ad04f0576bd42a25}{SYS}}-\/>particles[i].F[d]+=factor*metric\_noise[d];}
\DoxyCodeLine{00091 \}}

\end{DoxyCode}
